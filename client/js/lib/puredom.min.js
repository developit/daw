/*! puredom 05-01-2014 */
"function"!=typeof Date.now&&(Date.now=function(){return(new Date).getTime()}),function(){function a(a){var b=a,d=m[a];return d?d:(c&&a.substring(0,c.length)!==c&&(d=c+a.charAt(0).toUpperCase()+a.substring(1),d in document.body.style&&(b=d)),m[a]=b,b)}var b,c,d,e,f=window.puredom,g=function(){return k.puredom.apply(k,arguments)},h={version:"1.1.9",templateAttributeName:"data-tpl-id",baseAnimationInterval:20,allowCssTransitions:!0,easingMethods:{ease:function(a){return(Math.sin(a*Math.PI-Math.PI/2)+1)/2},"ease-in-out":function(a){return(Math.sin(a*Math.PI-Math.PI/2)+1)/2},"ease-in-out-2":function(a){return this["ease-in-out"](this["ease-in-out"](a))},"ease-in-out-3":function(a){return this["ease-in-out"](this["ease-in-out"](this["ease-in-out"](a)))}}},i=!1,j=h.constructor,k={oninit:[],animationTimes:{fast:150,medium:450,slow:1e3},animationTimeScale:1,registeredEventCount:0,html5elements:"abbr article aside audio canvas datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video".split(" "),support:{html5:!0,querySelectorAll:!!("querySelectorAll"in document),filters:!1,webkitMultitouch:!!("createTouch"in document)},regex:{css3AutoPrefix:/([\s\;\/\*])(transform|transition|perspective|box\-sizing|box\-shadow|border\-radius)\:([^\;]*)(\;|$)/gim,css3VendorPrefix:/\b\-(moz|webkit|ms|o|vendor)\-/gim,templateFieldToken:/([^\\]?)\{([a-z0-9A-Z\$_\.]+)(\|[^\}]*?)?\}/gm,parseObjectNameFromString:/^\[object ([^\s]+)\]$/gim,autoDetectHTMLContent:/(<[a-z]|&[a-z#0-9]{1,10};)/gim,whitespaceCharacters:/\s/,getNumericCSSValue:/[^0-9\.\-]/gm,getCSSValueUnits:/([a-z]+|%)$/,getNonIntegerCharsSigned:/[^0-9\.\-]/gm,getUpperCaseAlphaChars:/[A-Z]/gm},noop:function(){}};if(navigator.userAgent.match(/\b(webkit|applewebkit|chrome|chromium|khtml)\b/gim)?(b="-webkit",c="Webkit"):navigator.userAgent.match(/\bopera\b/gim)?(b="-o",c="O"):navigator.userAgent.match(/\bgecko\b/gim)?(b="-moz",c="Moz"):navigator.userAgent.match(/\bmsie\s*?(8|9|[1-9][0-9]+)\b/gim)?(b="-ms",c="Ms"):navigator.userAgent.match(/\bmsie\s*?[4-8]\b/gim)&&(k.support.filters=!0,k.support.filterProperty="filter"),function(a,b){if(a=document.createElement("div"),a.innerHTML="<nav></nav>",k.support.html5=a.childNodes.length>0,!k.support.html5){for(k.html5frag=document.createDocumentFragment(),b=k.html5elements.length;b--;)k.html5frag.createElement(k.html5elements[b]);k.html5div=document.createElement("div"),k.html5frag.appendChild(k.html5div)}}(),e=function(){var a=document.body;return d=void 0!==a.textContent&&"textContent"||a.innerText&&"innerText"||"innerHTML",e=null,d},g.extend=function(a){var b,c,d;for(a=a||{},b=1;b<arguments.length;b++)if(d=arguments[b]){for(c in d)d.hasOwnProperty(c)&&(a[c]=d[c]);"function"==typeof d.toString&&d.toString!==Object.prototype.toString&&(a.toString=d.toString)}return a},g.mixin=function(a){var b,c,d;for(a=a||{},b=1;b<arguments.length;b++)if(d=arguments[b])for(c in d)d.hasOwnProperty(c)&&!a.hasOwnProperty(c)&&(a[c]=d[c]);return a},g.strip=function(a,b){for(var c in a)(b===!0||a.hasOwnProperty(c))&&(a[c]=null)},g.delve=function(a,b,c,d){var e=0;for(b=b.split("."),c===!0&&b.splice(0,1);e<b.length&&a&&a.hasOwnProperty(b[e]);)a=a[b[e]],e+=1;return e>=b.length||d===!0&&e>0?a:void 0},g.flattenObj=function(a,b,c,d){var e,f;b=b||"",c=c||0,d=d||{};for(e in a)a.hasOwnProperty(e)&&(f=b?b+"_"+e:e,g.isScalar(a[e])?d[f]=a[e]:g.flattenObj(a[e],f,c+1,d));return c?void 0:d},g.template=function(a,b,c){var d,e;return c!==!1&&g.i18n&&(e=g.i18n),d=(a+"").replace(k.regex.templateFieldToken,function(a,c,d,f){var h;return"\\"!==c&&d?(h=g.delve(b,d),h?(e&&(h=e(h)||h),f&&"|"===f.substring(0,1)&&(h=g.text.filter(h,f.substring(1))),a=c+h):a=c):a=c,a})},g.inherits=function(a,b){function c(){}c.prototype=b.prototype;var d=a.prototype;a.prototype=new c,puredom.extend(a.prototype,d),a.prototype.constructor=a,a.prototype.__super=b},g.typeOf=function(a){if(void 0===a)return"undefined";if(null===a)return"null";if(a){if(a.constructor===j)return"object";if(g.isArray(a))return"array"}return Object.prototype.toString.call(a).replace(k.regex.parseObjectNameFromString,"$1").toLowerCase()},g.isScalar=function(a){var b=g.typeOf(a);return"undefined"===b||"null"===b||"number"===b||"string"===b||"boolean"===b?!0:!1},!Array.prototype.indexOf||0!==[g].indexOf(g))try{Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}}catch(l){}g.toArray=function(a){var b,c=[],d=a&&a.length;if(d||0===d)for(b=d;b--;)c[b]=a[b];else for(b=0;;){if(a.hasOwnProperty&&a.hasOwnProperty(b))c.push(a[b]);else{if(!a.hasOwnProperty||!a.hasOwnProperty(b+""))break;c.push(a[b+""])}b+=1}return c},g.isArray=Array.isArray?function(a){return Array.isArray(a)}:function(a){return"[object Array]"===Object.prototype.toString.call(a)},g.hasOwnProp=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},g.forEach=function(a,b){var c,d;if(g.isArray(a))for(c=0;c<a.length&&(d=b(a[c],c),d!==!1);c++);else for(c in a)if(a.hasOwnProperty(c)&&(d=b(a[c],c),d===!1))break;return a},g.foreach=g.forEach,g.setInnerHTML=function(a,b){var c,d;if(k.support.html5)a.innerHTML=b||"";else{for(a.innerHTML="",k.html5div.innerHTML=b||"",c=document.createDocumentFragment(),d=k.html5div.childNodes.length;d--;)c.appendChild(k.html5div.firstChild);a.appendChild(c)}},g.createElement=function(a,c){var d,e,f,h,i;if("string"==typeof a){for(h=document.createElement("div"),h.innerHTML=a,f=0;f<h.childNodes.length;f++)d=h.childNodes[f],1===d.nodeType&&c&&c.appendChild(d);return d}a=a||{},d=document.createElement(a.type||"div"),c=c||a.parent,a.insertBefore&&a.insertBefore.constructor===g.NodeSelection&&(a.insertBefore=a.insertBefore._nodes[0]),!c&&a.insertBefore&&(c=a.insertBefore.parentNode);for(e in a)if(g.hasOwnProp(a,e))if("on"===(e+"").substring(0,2).toLowerCase())g.addEvent(d,e.substring(2),a[e]);else if("css"===e||"cssText"===e)b?(a[e]=a[e].replace(k.regex.css3AutoPrefix,"$1"+b+"-$2:$3; $2:$3;"),a[e]=a[e].replace(k.regex.css3VendorPrefix,"-"+b+"-"),d.style.cssText=a[e]):d.style.cssText=a[e];else if("html"===e||"innerHTML"===e)g.setInnerHTML(d,a[e]);else if("attributes"===e)for(f in a[e])g.hasOwnProp(a[e],f)&&d.setAttribute(f,a[e][f]);else if("parent"!==e&&"children"!==e&&"insertBefore"!==e&&"type"!==e&&"children"!==e&&"html"!==e&&"innerHTML"!==e)if(document.all)try{d[e]=a[e]}catch(j){g.log(e)}else d[e]=a[e];if(c){if(a.insertBefore)try{c.insertBefore(d,a.insertBefore),i=!0}catch(j){i=!1}i||c.appendChild(d)}if(a.children&&g.isArray(a.children)){for(h=document.createDocumentFragment(),e=0;e<a.children.length;e++)g.createElement(a.children[e],h);d.appendChild(h)}return d},g.NodeSelection=function n(a){var b;if(this._results=[],this._nodes=[],this._animations=[],a)if(g.isArray(a))for(b=0;b<a.length;b++)a[b]&&(a[b].constructor===n&&a[b]._nodes?this._nodes.push(a[b]._nodes[0]):this._nodes.push(a[b]));else this._nodes.push(a)},g.extend(g.NodeSelection.prototype,{_results:[],_nodes:[],_animations:[],describe:function(){var a=[];return this.each(function(b){var c="<"+b.nodeName(),d=b.prop("id"),e=b.prop("className");d&&(c+=' id="'+d+'"'),e&&(c+=' class="'+e+'"'),c+=">",c+=1===b._nodes[0].childNodes.length&&3===b._nodes[0].childNodes[0].nodeType?b.text().replace(/(\r|\n)/gim,decodeURIComponent("%E2%86%A9")).replace(/\t/gim,decodeURIComponent("%E2%86%92")):"["+b.children().count()+" children]",c+="</"+b.nodeName()+">",a.push(c)}),a},toString:function(){return this.describe().join(", ")},toSource:function(){return this._nodes},getResult:function(a){return a=Math.round(a)||0,this._results[this._results.length-a-1]},pushResult:function(a){return this._results.push(a),this},each:function(a){return this._each(a,!0)},_each:function(a,b,c){var d,e,f,h,i=this._nodes.slice(0,this._nodes.length);for(d=0;d<i.length&&(e=d,c===!0&&(e=i.length-e-1),f=i[e],b===!0&&(f=new g.NodeSelection(f)),h=a.call(this,f,e),h!==!1);d++);return this},wait:function(a,b){var c=this;return b&&setTimeout(function(){b.apply(c),c=b=null},Math.abs(a)),this},nodeName:function(){var a=this._nodes[0],b=a&&a.nodeName&&a.nodeName.toLowerCase();return a===window?"#window":b?b:null},uuid:function(){return this._nodes[0]&&k.nodeToId(this._nodes[0])||null},text:function(a){return 0===arguments.length?this._nodes[0]&&this._nodes[0][d||e()]||"":(a+="",this._each(function(b){b[d||e()]=a}),this)},html:function(a,b){return 0===arguments.length?this._nodes[0]&&this._nodes[0].innerHTML||"":(a+="",k.regex.autoDetectHTMLContent.lastIndex=0,k.regex.autoDetectHTMLContent.test(a)&&b!==!0?this._each(function(b){g.setInnerHTML(b,a)}):this._each(function(b){b[d||e()]=a}),this)},css:function(a,b,c){var d,e=this;if(b=b||{},("string"==typeof b||"number"==typeof b)&&(b={tween:b}),!c&&b.callback&&(c=b.callback),c&&c.call||(c=k.noop),d=g.typeOf(b.tween),"string"==typeof a&&(a=k.parseCSS(a)),"string"===d&&"none"!==b.tween||"number"===d&&b.tween>0){var f,h,i=(b.tween+"").replace(k.regex.whitespaceCharacters,"").split(","),j=0,l=0;h=function(a){l+=1,l>=j&&(h=null,c&&c.call(e,e),e=c=a=null)};for(f in a)a.hasOwnProperty(f)&&(j+=1,this.animateCss(f,a[f],i[0],i[1],h))}else this._each(function(b){g.applyCss(b,a)}),c?setTimeout(function(){c.call(e,e),e=c=null},1):e=null;return this},show:function(){return this.css({display:"",visibility:"visible"}),this._each(function(a){("none"===a.style.display||"none"===g.nodeStyle(a,"display"))&&(a.style.display="block")}),this},hide:function(a){return this.css(a===!1?{visibility:"hidden"}:{display:"none"})},fadeIn:function(a,b){var c=parseFloat(this.getStyle("opacity")||"0")||0,d=1;return("none"===this.getStyle("display")||"hidden"===this.getStyle("visibility"))&&(this.getStyle("opacity")&&c>0&&1>c&&(d=c),c=0,this.css({opacity:0})),"function"===g.typeOf(a)&&(b=a,a=arguments[1]),c>=1||0===a||a===!1?(this.css({opacity:d}).show(),b&&b.call&&setTimeout(b,0),this):(this.css({opacity:d},{tween:a||"medium",callback:function(c){b&&b(c),a=b=null}}).show(),this)},fadeOut:function(a,b,c){var d=parseFloat(this.getStyle("opacity")||"1")||1;return"function"===g.typeOf(a)&&(b=a,a=arguments[1]),"boolean"===g.typeOf(b)&&(c=b,b=null,"function"===g.typeOf(arguments[2])&&(b=arguments[2])),0>=d||"none"===this.getStyle("display")||"hidden"===this.getStyle("visibility")||0===a||a===!1?(this.css({opacity:0}).hide(c),setTimeout(b,0),this):(this.css({opacity:0},{tween:a||"medium",callback:function(e){e.hide(c).css({opacity:d}),b&&b(e),a=b=null}}),this)},animateCSS:function(){var a,b,d,e;return a=function(a,b,c,d,e){var f,h,i,j=[],l=[];return a=a.toLowerCase(),"auto"!==b?(f=parseFloat((b+"").replace(k.regex.getNumericCSSValue,""))||0,i="string"===g.typeOf(b)&&b.match(k.regex.getCSSValueUnits),h=i&&i[0]||"px","opacity"===a&&(h="")):h="opacity"===a?"":"px",this._each(function(c,d){var e,i,m,n,o={};j[d]=parseFloat((g.nodeStyle(c,a)+"").replace(k.regex.getNonIntegerCharsSigned,""))||0,"auto"===b||""===b?(n=c.style.visibility||"",o[a]=b,o.visibility="hidden",g.applyCss(c,o),e=g.nodeStyle(c,a),(e===b||e.indexOf("px")<e.length-3)&&(m=a.substring(0,1).toUpperCase()+a.substring(1).toLowerCase(),e=c["offset"+m]+"px"),i="string"===g.typeOf(e)&&e.match(k.regex.getCSSValueUnits),l[d]={_actualTarget:b,numericTargetValue:parseFloat((e+"").replace(k.regex.getNumericCSSValue,""))||0,units:"opacity"===a?"":i&&i[0]||"px"},setTimeout(function(){c.style.visibility=n,c=null},51),o=e=i=null):l[d]={numericTargetValue:f,units:h}}),this.animate(function(b){this._each(function(c,d){var e,f={},h=b*(l[d].numericTargetValue-j[d])+j[d],i=l[d].units;"px"===i?h=Math.round(h):(e=parseFloat(h),h=0===e%1?Math.round(e):e.toFixed(2)),f[a]=h+i,g.applyCss(c,f)})},c,d,function(b){b._each(function(b,c){var d={};l[c]._actualTarget&&(d[a]=l[c]._actualTarget,g.applyCss(b,d))}),e.apply(b,arguments)})},b=function(a,b,c,d,e){var f=this._createAnimationObj(function(){},c,d,e),h=this,i={},j={};a=g.getStyleAsProperty(a),"number"===g.typeOf(b)&&"opacity"!==(a+"").toLowerCase()&&(b+="px"),i[g.getStyleAsCSS(a)]={duration:f.duration,timingFunction:f.easing},j[a]=b,setTimeout(function(){h._each(function(a){g.updateCssTransitions(a,i),g.applyCss(a,j),k.incrementAnimationCount(a)}),f._cb=function(){if(f){var b={};b[a]=null,h._each(function(a){g.updateCssTransitions(a,b),k.decrementAnimationCount(a)}),f.callback&&f.callback.call(h,h);for(var c in f)if(f.hasOwnProperty(c))try{delete f[c]}catch(d){}}f=j=e=h=null},setTimeout(f._cb,(parseInt(f.duration,10)||0)+20)},10)},e=function(){return d=void 0!==document.body.style[c+"Transition"]||void 0!==document.body.style.transition},function(){var c=!1;return"boolean"!==g.typeOf(d)&&e(),g.allowCssTransitions===!1&&c!==!0||!d?a.apply(this,arguments):b.apply(this,arguments),this}}(),animate:function(a){if(a){var b,c=this,d=this._createAnimationObj.apply(this,arguments);this._each(function(a){k.incrementAnimationCount(a)}),b=function(a){if(d.frameTime=a,d.position=d.frameTime-d.start,d.fraction=d.position/d.duration,d.position>=d.duration?(d.fraction=1,d.position=d.duration):d.easingMethod&&(d.fraction=d.easingMethod.call(g.easingMethods,d.fraction,d)),d.animator.call(c,d.fraction,d),1===d.fraction){for(var e=c._animations.length;e--;)if(c._animations[e]===d){c._animations.splice(e,1);break}d.callback&&setTimeout(function(){c._each(function(a){k.decrementAnimationCount(a)}),d.callback.call(c,c,d),c=d=null},10)}else d.timer=g.animationFrame.getTimer(b,g.baseAnimationInterval||10)},g.animationFrame.getTimer(b,g.baseAnimationInterval||10),this._animations.push(d)}return this},_createAnimationObj:function(a,b,c,d){var e={animator:a,duration:b,easing:"string"===g.typeOf(c)?c:"ease",callback:d,start:g.animationFrame.getStartTime(),frameTime:null};if("string"===g.typeOf(e.duration))switch(e.duration.toLowerCase()){case"long":case"slow":e.duration=k.animationTimes.slow;break;case"short":case"fast":e.duration=k.animationTimes.fast;break;default:e.duration=parseInt(e.duration,10)||k.animationTimes.medium}else e.duration=Math.round(e.duration)||k.animationTimes.medium;return k.animationTimeScale&&(e.duration*=k.animationTimeScale),e.easing&&g.easingMethods.hasOwnProperty(e.easing)?e.easingMethod=g.easingMethods[e.easing]:e.easing=null,e},classify:function(){var a,b,c=[],d="{*^de^*}"===arguments[0]?"removeClass":"addClass";for(a=0;a<arguments.length;a++)if(g.isArray(arguments[a]))for(b=0;b<arguments[a].length;b++)c.push(arguments[a][b]);else c.push(arguments[a]);return this._each(function(a){g[d](a,c)}),this},declassify:function(){var a=["{*^de^*}"].concat(Array.prototype.slice.call(arguments,0));return this.classify.apply(this,a)},hasClass:function(a,b){var c=b!==!0;return this._each(function(d){var e=(" "+d.className+" ").indexOf(" "+a+" ")>-1;b===!0?e&&(c=!0):e||(c=!1)}),c},setOpacity:function(a){return this._each(function(b){g.setOpacity(b,a)}),this},sumOf:function(a){var b=0,c=Array.prototype.slice.call(arguments,1);return this.constructor.prototype.hasOwnProperty(a)&&this._each(function(d){d=new g.NodeSelection(d),b+=d[a].apply(d,c)}),b},height:function(a,b){var c,d,e=0;return"object"!==g.typeOf(a)||b||(b=a,a=null),b=b||{},a||0===a?(a+="","auto"===a?c="":(d=/^([\-0-9\.]+)(.*?)$/.exec(a),a=Math.round(d&&d[1]||a)||0,c=d&&d[2]||"px"),this.css({height:a+c}),this):(this._each(function(a){e+=parseInt(a.offsetHeight,10)||0,b.border!==!0&&(e-=parseInt((g.nodeStyle(a,"border-top-width")+"").replace(k.regex.getNonIntegerCharsSigned,""),10)||0,e-=parseInt((g.nodeStyle(a,"border-bottom-width")+"").replace(k.regex.getNonIntegerCharsSigned,""),10)||0),b.margin===!0&&(e+=parseInt((g.nodeStyle(a,"margin-top")+"").replace(k.regex.getNonIntegerCharsSigned,""),10)||0,e+=parseInt((g.nodeStyle(a,"margin-bottom")+"").replace(k.regex.getNonIntegerCharsSigned,""),10)||0),b.padding===!1&&(e-=parseInt((g.nodeStyle(a,"padding-top")+"").replace(k.regex.getNonIntegerCharsSigned,""),10)||0,e-=parseInt((g.nodeStyle(a,"padding-bottom")+"").replace(k.regex.getNonIntegerCharsSigned,""),10)||0)}),e)},width:function(a,b){var c,d,e=0;return"object"!==g.typeOf(a)||b||(b=a,a=null),b=b||{},a||0===a?(a+="","auto"===a?c="":(d=/^([\-0-9\.]+)(.*?)$/.exec(a),a=d&&d[1]||a,c=d&&d[2]||"px"),this.css({width:a+c}),this):(this._each(function(a){e+=parseInt(a.offsetWidth,10)||0,b.border!==!0&&(e-=parseInt((g.nodeStyle(a,"border-left-width")+"").replace(k.regex.getNonIntegerCharsSigned,""),10)||0,e-=parseInt((g.nodeStyle(a,"border-right-width")+"").replace(k.regex.getNonIntegerCharsSigned,""),10)||0),b.margin===!0&&(e+=parseInt((g.nodeStyle(a,"margin-left")+"").replace(k.regex.getNonIntegerCharsSigned,""),10)||0,e+=parseInt((g.nodeStyle(a,"margin-right")+"").replace(k.regex.getNonIntegerCharsSigned,""),10)||0),b.padding===!1&&(e-=parseInt((g.nodeStyle(a,"padding-left")+"").replace(k.regex.getNonIntegerCharsSigned,""),10)||0,e-=parseInt((g.nodeStyle(a,"padding-right")+"").replace(k.regex.getNonIntegerCharsSigned,""),10)||0)}),e)},x:function(a){var b=this._nodes[0],c=null;if(b&&(c=b.offsetLeft,a===!0))for(;(b=b.parentNode)&&b!==document;)c+=parseFloat(b.offsetLeft)||0;return c},y:function(a){var b=this._nodes[0],c=null;if(b&&(c=b.offsetTop,a===!0))for(;(b=b.parentNode)&&b!==document;)c+=parseFloat(b.offsetTop)||0;return c},position:function(a,b,c,d){var e;return d=d||"px",arguments.length<1||1===arguments.length&&arguments[0]===!0?{x:this.x(arguments[0]===!0),y:this.y(arguments[0]===!0)}:(e={},"number"===puredom.typeOf(a)?e.left=a+d:"string"===puredom.typeOf(a)&&(e.left=a),"number"===puredom.typeOf(b)?e.top=b+d:"string"===puredom.typeOf(b)&&(e.top=b),this.css(e,c),this)},scrollLeft:function(a){return a||0===a?("number"!==g.typeOf(a)&&(a=Math.round((a+"").replace(k.regex.getNonIntegerCharsSigned,""))),this._each(function(b){b.scrollLeft=a}),void 0):this._nodes&&this._nodes[0]&&this._nodes[0].scrollLeft||0},scrollTop:function(a){return a||0===a?("number"!==g.typeOf(a)&&(a=Math.round((a+"").replace(k.regex.getNonIntegerCharsSigned,""))),this._each(function(b){b.scrollTop=a}),void 0):this._nodes&&this._nodes[0]&&this._nodes[0].scrollTop||0},focus:function(){return this._each(function(a){a.focus&&a.focus()}),this},blur:function(){return this._each(function(a){a.blur&&a.blur()}),this},selectAll:function(){this._each(function(a){a.SelectAll&&a.SelectAll(),a.select&&a.select(),a.selectionStart&&a.hasOwnProperty("value")&&(a.selectionStart=0,a.selectionEnd=a.value.length)})},getStyle:function(a,b){var c=[];return this._each(function(b){c.push(g.nodeStyle(b,a)||null)}),b===!1?(this.pushResult(c),this):c.length<=1?c[0]:c},value:function(a,b){if(b=b||{},null!==a&&void 0!==a&&arguments.length>0)return this._each(function(c){var d=(c.nodeName+"").toLowerCase(),e=(c.getAttribute("type")||"").toLowerCase();"input"!==d||"checkbox"!==e&&"radio"!==e?c.value=a:c.checked=!!a,b.fireChange!==!1&&g.fireEvent({type:"change",target:c,value:a})}),this;var c=[];return this._each(function(a){var b,d=(a.nodeName+"").toLowerCase(),e=(a.getAttribute("type")||"").toLowerCase();"input"!==d||"checkbox"!==e&&"radio"!==e?"select"===d?(b=a.multiselect||a.multiSelect?[]:null,g.el(a).query("option")._each(function(a){(a.selected||a.checked)&&(g.isArray(b)?b.push(a.value):b=a.value)}),c.push(b)):c.push(a.value):c.push(!!a.checked)}),c.length<2?c[0]||null:c},attr:function(a,b,c){var d,e,f=[];if(0===arguments.length){for(f={},d=this._nodes[0].attributes.length;d--;)e=this._nodes[0].attributes[d],e.specified&&(f[e.name||e.nodeName]=e.value||e.nodeValue);return f}if(arguments.length>1){if("object"===g.typeOf(a)){for(d in a)"string"==typeof d&&a.hasOwnProperty(d)&&this.attr(f,a[d]);return this}return this._each(function(c){try{c.setAttribute(a,b),!c.removeAttribute||null!==b&&void 0!==b||c.removeAttribute(a)}catch(d){}})}return this._each(function(b){var c=b.getAttribute(a);"string"!=typeof c&&(c=null),f.push(c)}),c===!1?(this.pushResult(f),this):f.length<=1?f[0]:f},prop:function(a,b,c){var d=[];return arguments.length>1?this._each(function(c){if(c[a]=b,void 0===b)try{delete c[a]}catch(d){}}):(this._each(function(b){var c;try{c=b[a]}catch(e){g.log("NodeSelection#prop("+a+") :: Access Error",e)}d.push(c||null)}),c===!1?(this.pushResult(d),this):d.length<=1?d[0]:d)},enable:function(){return this.attr("disabled",null),this.declassify("_puredom_disabled"),this},disable:function(){return this.attr("disabled","disabled"),this.classify("_puredom_disabled"),this},enabled:function(a){return a===!0||a===!1?(this[a?"enable":"disable"](),this):"disabled"!==this.attr("disabled")&&this.prop("disabled")!==!0&&!this.hasClass("_puredom_disabled")},addEvent:function(a,b,c){return this._each(function(d){g.addEvent(d,a,b,c)}),this},removeEvent:function(a,b,c){return this._each(function(d){g.removeEvent(d,a,b,c)}),this},fireEvent:function(a,b){return this._each(function(c){g.fireEvent(g.extend({},b||{},{type:a,target:c}))}),this},_removeAllEvents:function(a){var b;return this._each(function(a){k.wrappedEventListener.destroyObjHandlers(a,!0)}),b=this.children(),a===!0&&b.count()>0&&b._removeAllEvents(!0),b=a=null,this},appendChild:function(a){if(a&&this._nodes.length>0)if(a.constructor===this.constructor){var b=this._nodes[0];a._each(function(a){b.appendChild(a)})}else this._nodes[0].appendChild(a);return this},insertBefore:function(a,b){if(a&&this._nodes.length>0){if(b&&b.constructor===this.constructor&&(b=b._nodes[0]),!b||b.parentNode!==this._nodes[0])return this.appendChild(a);if(a.constructor===this.constructor){var c=this._nodes[0];a._each(function(a){c.insertBefore(a,b)},null,!0)}else this._nodes[0].insertBefore(a,b)}return this},insertInto:function(a){var b;return a&&this.count()>0&&(a.constructor===this.constructor&&(a=a._nodes[0]),1===this.count()?a.appendChild(this._nodes[0]):(b=document.createDocumentFragment(),this._each(function(a){b.appendChild(a)},null,!0),k.support.filters!==!0&&a.appendChild(b))),this},remove:function(){return this.fireEvent("remove"),this._each(function(a){a.parentNode&&a.parentNode.removeChild(a)}),this},destroy:function(){return this.remove(),this.fireEvent("destroy"),this._removeAllEvents(!0),this._nodes.splice(0,this._nodes.length),this},query:function(a,b){var c=[];return this._nodes.length>0&&(b=puredom.extend({},b||{}),this._each(function(d){var e;b.within=d,e=g.getElement(a,b),g.isArray(e)&&e.length>0&&(c=c.concat(e))})),new g.NodeSelection(c)},clone:function(a,b){var c=[];return b===!0&&(b=this.parent()),this._each(function(b){c.push(b.cloneNode(a!==!1))}),c=new g.NodeSelection(c),b&&b.appendChild(c),c._each(k.removeNodeUID),a!==!1&&c.query("*")._each(k.removeNodeUID),c},count:function(){return this._nodes.length},exists:function(){return this.count()>0},siblings:function(){var a=new g.NodeSelection;return this._each(function(b){for(var c=b;c=c.previousSibling;)"#text"!==c.nodeName&&"#comment"!==c.nodeName&&3!==c.nodeType&&a._nodes.push(c);for(c=b;c=c.nextSibling;)"#text"!==c.nodeName&&"#comment"!==c.nodeName&&3!==c.nodeType&&a._nodes.push(c)}),a},next:function(){for(var a=this._nodes[0]&&this._nodes[0].nextSibling;a&&3===a.nodeType;)a=a.nextSibling;return new g.NodeSelection(a&&[a]||null)},prev:function(){for(var a=this._nodes[0]&&this._nodes[0].previousSibling;a&&3===a.nodeType;)a=a.previousSibling;return new g.NodeSelection(a&&[a]||null)},previous:function(){return this.prev.apply(this,arguments)},firstChild:function(){return this.children().first()},lastChild:function(){return this.children().last()},nthChild:function(a){return this.children().index(a)},first:function(a){return new g.NodeSelection(this._nodes.slice(0,a||1))},last:function(a){return new g.NodeSelection(this._nodes.slice(this._nodes.length-(a||1)))},index:function(a,b){return new g.NodeSelection("number"===g.typeOf(a)&&this._nodes.slice(a,a+(b||1))||null)},parent:function(){var a,b=[];return this._each(function(c){a=c.parentNode,a&&b.indexOf(a)<0&&11!==a.nodeType&&b.push(a)}),new g.NodeSelection(b)},children:function(){var a,b,c=[];if(this._nodes.length>0)for(a=0;a<this._nodes.length;a++)if(this._nodes[a].childNodes)for(b=0;b<this._nodes[a].childNodes.length;b++)3!==this._nodes[a].childNodes[b].nodeType&&"#text"!==this._nodes[a].childNodes[b].nodeName&&"#comment"!==this._nodes[a].childNodes[b].nodeName&&c.push(this._nodes[a].childNodes[b]);return new g.NodeSelection(c)},submit:function(){return this._each(function(a){var b=g.fireEvent({type:"submit",target:a});b.rval!==!1&&b.returnValue!==!1&&b.preventDefault!==!0&&a.submit&&a.submit()})},selection:function(a,b){var c,d,e,f,h,i=this._nodes[0];return a&&"number"!=typeof a&&a.start&&(b=a.end,a=a.start),"number"!=typeof a?window.getSelection?(c="string"==typeof i.value?i.value:i.innerHTML,d=window.getSelection(),{start:i.selectionStart+0,end:i.selectionEnd+0,text:c.substring(d.start,d.end)}):document.selection?(d=document.selection.createRange(),e=document.body.createTextRange(),e.moveToElementText(i),e.setEndPoint("EndToStart",d),{start:e.text.length,end:e.text.length+d.text.length,text:d.text}):(g.log("Selection retrieval is not supported in this browser."),{start:0,end:0,text:""}):(0>a&&(a=0),f=i.value.length,b>f&&(b=f),a>b?a=b:a>b&&(b=a),window.getSelection?(i.selectionStart=a,i.selectionEnd=b):i.selectionEnd||0===i.selectionEnd?(i.selectionStart=a,i.selectionEnd=b):i.createTextRange&&(h=i.createTextRange(),h.collapse(!0),h.moveStart("character",a),h.moveEnd("character",b),h.select()),this)},template:function(a){var b,c=g.templateAttributeName;return a=a||{},b=function(a){var b,c=a.split("|");for(a=c.splice(0,1)[0],b=c.length;b--;)"htmlEntities"===c[b]&&c.splice(b,1);return c},this.query("["+c+"]").each(function(d){var e,f,h=d.nodeName(),i=d.attr(c),j=i;if(e=b(i),i=i.split("|")[0],j=puredom.delve(a,i),null!==j&&void 0!==j)if(("date"==typeof j||j.constructor===Date)&&(j=j.toLocaleString()),f=d.attr("data-tpl-prop"))d.prop(f,g.text.filter(j,e.join("|")));else switch(h){case"select":case"input":case"textarea":case"meter":case"progress":d.value(j);break;case"img":case"video":case"audio":case"iframe":e.splice(0,0,"htmlEntities"),j=g.text.filter(j,e.join("|")),d.attr("src",j);break;default:e.splice(0,0,"htmlEntities"),j=g.text.filter(j,e.join("|")),d.html(j)}}),a=null,this}}),g.NodeSelection.prototype.on=g.NodeSelection.prototype.addEvent,g.NodeSelection.prototype.animateCss=g.NodeSelection.prototype.animateCSS,k.incrementAnimationCount=function(a){a._puredom_animationCount=k.getAnimationCount(a)+1,1===a._puredom_animationCount&&g.addClass(a,"_puredom_animating")},k.decrementAnimationCount=function(a){var b=Math.max(0,k.getAnimationCount(a));b>1?a._puredom_animationCount=b-1:(a._puredom_animationCount=null,g.removeClass(a,"_puredom_animating"))},k.getAnimationCount=function(a){return parseInt(a._puredom_animationCount,10)||0},k.unload=function(){k.wrappedEventListener.reset(),g.getElement.clearCache(),k._nodeToIdList={},setTimeout(function(){window.puredom=k=j=e=null},10)},g.el=function(a,b){var c,d;if(a){if(d=g.typeOf(a),"array"===d){c=[];for(var e=0;e<a.length;e++)Array.prototype.splice.apply(c,[0,0].concat(g.el(a[e])._nodes))}if(a.constructor===g.NodeSelection)return b===!0&&g.log("query is already a NodeSelection",a.constructor+"",a.constructor.name),a;"string"===d&&"<"===a.charAt(0)||"object"===d&&!a.nodeName&&a!==window?(b===!0&&g.log("query is an HTML fragment",a,d),c=g.createElement.apply(g,arguments)):"string"===d?(b===!0&&g.log("query is a CSS selector",a,d),c="body"===a?document.body:"html"===a?document.documentElement||document:g.getElement(a,arguments[1])):(a.nodeName||a===window)&&(b===!0&&g.log("query is an HTML element",a,d),a===window&&(a=document.documentElement||document),c=a)}return new g.NodeSelection(c)},g.node=function(a){return new g.NodeSelection(k.idToNode(a))},g.getElement=function(){var a,b,c,d={},e=!1,f=/^((?:[a-z][a-z0-9\_\-]*)|\*)?/gi,h=/^\s*(.*?)\s*$/gm,i=!1;return c=[{title:"ID selector {#id}",regex:/^#[_a-zA-Z0-9-]*/gm,filter:function(a,b,c){var d=c.searchBaseNode&&c.searchBaseNode.getElementById?c.searchBaseNode:document;return[d.getElementById(a[0].substring(1))]}},{title:"Class selector {.className}",regex:/^\.([^#.:\[<>\{+\|\s]+)/gim,filter:function(a,b){var c,d,e=" "+a[1]+" ";for(c=b.length;c--;)d=b[c]&&b[c].className,d&&-1!==(" "+d+" ").indexOf(e)||b.splice(c,1)}},{title:"Attribute selector {[name=value] & variants}",regex:/^\[([^\^\$\~=]+)(?:([\^\$\~=]+)(['"]?)([^\]]*))?\3\]/g,filter:function(a,b){var c,d,e,f,h;if(a&&a[1])for(d={attribute:a[1]},a[2]&&a[4]&&(d.type=a[2],d.attrValue=a[4]||""),c=b.length;c--;){switch(e=!1,f="checked"===d.attribute?"true"===d.attrValue||"false"===d.attrValue?b[c].checked?"true":"false":b[c].checked?"checked":null:"selected"===d.attribute?"true"===d.attrValue||"false"===d.attrValue?b[c].selected?"true":"false":b[c].selected?"selected":null:b[c]&&b[c].getAttribute(d.attribute+""),d.attrPresent="string"===g.typeOf(f),d.attrSet=f&&f.length>0,d.attrValue&&(h=d.attrPresent?f.indexOf(d.attrValue):-1),d.type||""){case"=":e=f===d.attrValue;break;case"^=":e=0===h;break;case"$=":e=d.attrSet&&f.substring(f.length-d.attrValue.length)===d.attrValue;break;case"~=":e=h>-1;break;default:e=!d.attrValue&&d.attrPresent}e||b.splice(c,1)}}},{title:"Descendant selector {>}",regex:/^\s*\>\s*((?:[a-z][a-z0-9\:\_\-]*)|\*)?/gi,filter:function(a,b,c){var d,e,f,h,i=[].concat(b),j=(a[1]||"*").toLowerCase();for(b.splice(0,b.length),!c.isFiltered&&c.first&&g.log("Descendant selector called on an unfiltered result set.  Operating on descendants of the document."),(!c.isFiltered||c.first)&&(i=[c.searchBaseNode]),d=0;d<i.length;d++)for(f=i[d].childNodes,e=0;e<f.length;e++)h=(f[e].nodeName+"").toLowerCase(),(h===j||"*"===j&&"#"!==h.charAt(0)&&(1===f[e].nodeType||9===f[e].nodeType))&&b.push(f[e])}},{title:"nth-child aliases, like :first-child",regex:/^\:(first|last|only)\-(child|of\-type)/gm,filter:function(a,b,d){var e,f,h,i,j={"first-child":":nth-child(0n+1)","first-of-type":":nth-of-type(0n+1)","last-child":":nth-last-child(0n+1)","last-of-type":":nth-last-of-type(0n+1)"};for(e=c.length;e--;)if(c[e].isNthChildSelector===!0){f=c[e];break}return j.hasOwnProperty(a[1]+"-"+a[2])&&f?(h=j[a[1]+"-"+a[2]],f.regex.lastIndex=0,i=f.regex.exec(h),f.filter(i,b,d)):(g.log('Unknown nth-child alias "'+a[1]+"-"+a[2]+'"'),void 0)}},{isNthChildSelector:!0,title:"nth-child selector {:nth-child(n+2) & variants}",regex:/^\:(nth(?:\-last)?(?:\-of\-type|\-child))\((?:(\-?[0-9]*n(?:[+-][0-9]+)?)|([0-9]+)|([a-z]+))\)/gm,filter:function(a,b){var c,d,e,f,h,i,j,k,l,m,n=-1!==a[1].indexOf("-of-type"),o={odd:[2,1],even:[2]};if(c=b.splice(0,b.length),-1!==a[1].indexOf("-last")&&c.reverse(),a[2]?(f=a[2].split("n"),0===f[0].replace("-","").length&&(f[0]=f[0]+"1"),l=Math.round(f[0].replace("+",""))||0,m=Math.round(f[1].replace("+",""))||0):a[3]?(l=0,m=Math.round(a[3])||0):a[4]&&(f=a[4].toLowerCase(),o.hasOwnProperty(f)?(l=o[f][0]||0,m=o[f][1]||0):g.log('Unknown named nth-child expression "'+r[4]+'"')),!(0>=l+m))for(l===m&&(m=0),d=0;d<c.length;d++){if(children=(c[d].parentNode||{}).childNodes,i=(c[d].nodeName+"").toLowerCase(),isMatch=!1,children)for(k=0,e=0;e<children.length&&(j=children[e],h=n?(j.nodeName+"").toLowerCase()===i:"#"!==(j.nodeName+"").substring(0,1)||1===j.nodeType||9===j.nodeType,!h||(k+=1,j!==c[d]||!(isMatch=l>0?0===k%l-m:k===m)));e++);isMatch&&b.push(c[d])}}},{title:"within_internal selector { }",regex:/^\s+((?:[a-z][a-z0-9\:\_\-]*)|\*)?/gi,filter:function(a,b){var c,d=[].concat(b),e=a[1]||"*";for(b.splice(0,b.length),c=0;c<d.length;c++)Array.prototype.splice.apply(b,[b.length-1,0].concat(g.toArray(d[c].getElementsByTagName(e))))}}],b=function(a){a.lastIndex=0},a=function(j,l){var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=document&&document.documentElement||document,B=j,C=0,D=!1,E=!k.support.querySelectorAll,F=Date.now();if(j=(j+"").replace(h,"$1"),l=puredom.extend({},l||{}),l.logging===!0&&(D=!0),e&&l.useCache===!0&&d[j])return d[j];if(l.within&&(A=l.within),A&&A.length&&!A.nodeName&&A.indexOf&&A[0]&&(A=A[0]),j.indexOf(",")>-1){for(j=j.split(","),n=[],z=j.length;z--;)if(j[z]=j[z].replace(h,"$1"),j[z].length>0&&(t=a(j[z],puredom.extend({},l,{logging:!1,internalLogging:D,internal:!0}))))for(y=0;y<t.length;y++)-1===n.indexOf(t[y])&&n.push(t[y]);
return D&&g.log("query=",B,", result=",node),F=Date.now()-F,F>100&&g.log('Slow Selector Warning: "'+B+'" took '+F+"ms to complete."),n}if(o=j.match(f),o=(o&&o[0]||"").toLowerCase(),j=j.substring(o.length),s=j,">"===B.charAt(0)&&(E=!0),s.match(/^#[^\s\[\]\(\)\:\*\.\,<>#]+$/gim))m=[(A.getElementById?A:document).getElementById(s.substring(1))],E=!1;else if(k.support.querySelectorAll&&E!==!0){p=B.replace(/(\[[^\[\]= ]+=)([^\[\]"']+)(\])/gim,'$1"$2"$3');try{m=g.toArray(A.querySelectorAll(p)||[])}catch(G){g.log("Native querySelectorAll failed for selector: ",p,", error:",G.message),m=[],E=!0}}if(E)for("#"===j.substring(0,1)?m=[]:o&&"*"!==o||!document.all||window.opera||A!==document&&A!==document.documentElement?(m=g.toArray(A.getElementsByTagName(o||"*")),v=!0):(m=g.toArray(A.all||document.all),v=!1),q={searchBaseNode:A,negated:!1,first:!0,isFiltered:v||!(!o||"*"===o)};s.length>0;){for(C+=1,u=!1,y=0;y<c.length&&(i===!0&&(w=Date.now()),b(c[y].regex),t=c[y].regex.exec(s),i===!0&&(w=Date.now()-w),t&&(u=!0,D&&g.log((c[y].title||c[y].regex)+' ==>> matched:"'+s.substring(0,t[0].length)+'" ==>> remaining:"'+s.substring(t[0].length)+'" ||debug>> (submatches:'+t.slice(1).join(",")+")"),i===!0&&(x=Date.now()),r=c[y].filter(t,m,q),r&&g.isArray(r)&&(m=r),i===!0&&(x=Date.now()-x),s=s.substring(t[0].length),q.first=!1,q.isFiltered=!0),i===!0&&(c[y].matchTimes.push(w),u&&c[y].filterTimes.push(x)),0!==s.length);y++);if(!u)throw new Error("puredom.getElement() :: Unknown CSS selector near: "+s.substring(0,20),"puredom.js",2689)}if(l.includeInvisibles!==!0)for(y=m.length;y--;)m[y]&&"#"===(m[y].nodeName+"").charAt(0)&&m.splice(y,1);return D&&g.log("query=",B,", result=",m),e&&l.cache===!0&&(d[j]=m),l.internal!==!0&&D===!0&&(F=Date.now()-F,F>10&&g.log('Slow Selector Warning: "'+B+'" took '+F+"ms to complete. "+C+" parse iterations.")),m},a.enableCache=function(a){e=a!==!1,e||(d={})},a.disableCache=function(){e=!1,d={}},a.clearCache=function(){d={}},a._normalizeSelectorFilter=function(a){return 2===arguments.length&&(a={regex:arguments[0],filter:arguments[1]}),a&&a.regex&&a.filter?a:!1},a.addSelectorFilter=function(b){return b=a._normalizeSelectorFilter.apply(a,arguments),b?(c.push(b),!0):!1},a.removeSelectorFilter=function(b){var d,e,f;if(b=a._normalizeSelectorFilter.apply(a,arguments))for(d=c.length;d--;){f=!0;for(e in c[d])if(c[d].hasOwnProperty(e)&&c[d][e]!==b[e]){f=!1;break}if(f){c.splice(d,1);break}}return f===!0},i===!0?(!function(){for(var a=0;a<c.length;a++)c[a].matchTimes=[],c[a].filterTimes=[]}(),a.selectorStats=function(){var a,b,d,e,f,g,h={title:"--- Selector Statistics: ---",selectors:[]};for(b=0;b<c.length;b++){if(d=c[b],a={},a.title=d.title,g=0,d.matchTimes.length>0){for(f=0,e=0;e<d.matchTimes.length;e++)f+=d.matchTimes[e];g+=f,a.matching=Math.round(f/d.matchTimes.length)+"ms"}if(d.filterTimes.length>0){for(f=0,e=0;e<d.filterTimes.length;e++)f+=d.filterTimes[e];g+=f,a.filtering=Math.round(f/d.filterTimes.length)+"ms"}a.own_time=g+"ms",a.calls=d.matchTimes.length,h.selectors.push(a)}return h}):a.selectorStats=function(){return"disabled"},a}(),g.selectorEngine=g.getElement,g.DOMEvent=function(a){a&&(this.type=a.replace(/^on/gi,""))},g.DOMEvent.displayName="puredom.DOMEvent",g.extend(g.DOMEvent.prototype,{which:null,type:"",target:null,relatedTarget:null,preventDefault:function(){this.defaultPrevented=!0},stopPropagation:function(){this.propagationStopped=!0,this.bubblingCancelled=!0},cancel:function(){return this.preventDefault(),this.stopPropagation(),this.returnValue=!1,!1},returnValue:!0,originalEvent:null,timeStamp:null}),g.DOMEvent.prototype.cancelBubble=g.DOMEvent.prototype.stopPropagation,g.DOMEvent.prototype.stop=g.DOMEvent.prototype.cancel,g.DOMEvent.prototype.prevent=g.DOMEvent.prototype.cancel,k.wrappedEventListener={list:[],none:{},summary:function(){for(var a=0;a<this.list.length;a++)g.log(k.idToNode(this.list[a].target),".on",this.list[a].type," -> ",this.list[a].handler.displayName||this.list[a].handler.name)},reset:function(a){var b,c;if(a===!0)for(b=this.list.length;b--;)c=this.list[b],this.list[b]=this.none,g.removeEvent(k.idToNode(c.target),c.type,c.wrappedHandler),this.unsetRefs(c),window.killCount=(window.killCount||0)+1;this.list.splice(0,this.list.length)},destroyObjHandlers:function(a){var b,c,d=k.nodeToId(a);for(b=this.list.length;b--;)c=this.list[b],c.target===d&&(this.unsetRefs(c),this.list.splice(b,1),g.removeEvent(a,c.type,c.wrappedHandler),window.killCount=(window.killCount||0)+1)},get:function(a,b,c,d){var e,f;for(c=k.nodeToId(c),e=this.list.length;e--;)if(f=this.list[e],f.target===c&&f.handler===b&&f.type===a){b=f.wrappedHandler,d===!0&&(this.list.splice(e,1),window.killCount=(window.killCount||0)+1,this.unsetRefs(f));break}return b},unsetRefs:function(a){a.wrappedHandler.type=null,a.wrappedHandler.handler=null,a.wrappedHandler.target=null},internalFireEvent:function(a){var b,c,d,e=k.nodeToId(a.target),f=a.type.replace(/^on/gm,"");for(b=this.list.length;b--&&(c=this.list[b],c.target!==e||c.type!==f||(d=c.handler.call(a.target,a),d!==!1)););},create:function(a,b,c){var d={type:a,target:k.nodeToId(c),handler:b,wrappedHandler:function(a){var b,c,d=arguments.callee.handler,e=(arguments.callee.type||a.type).toLowerCase().replace(/^on/,""),f=this!==window?this:k&&k.idToNode(arguments.callee.target),h={isInSelf:!1,doPreventDefault:!1,doCancelBubble:!1,doStopPropagation:!1,e:a||window.event,ret:null,end:function(){return h.end=null,a=b=h=d=e=f=null,this.ret}};k&&k.idToNode||g.log("target:<"+a.target.nodeName+' class="'+a.target.className+'" id="'+a.target.id+'"'+"> , type:"+e+"/"+a.type),a=h.e,b=g.extend(new g.DOMEvent(e),{which:a.which,target:a.target||a.srcElement||f||document.body,relatedTarget:a.relatedTarget||("mouseout"===e?a.toElement:a.fromElement),returnValue:!0,originalEvent:a,timeStamp:a.timeStamp||Date.now()});for(c in a)b.hasOwnProperty(c)||"function"==typeof a[c]||c===c.toUpperCase()||"layerX"===c||"layerY"===c||(b[c]=a[c]);b.target||g.log("Event target doesn't exist for type \""+b.type+'": ',b.target,", srcElement=",a.srcElement),"touchend"===a.type&&k._lastTouchPos?(b.pageX=k._lastTouchPos.pageX,b.pageY=k._lastTouchPos.pageY):a.touches&&a.touches[0]?(b.pageX=a.touches[0].pageX,b.pageY=a.touches[0].pageY,k._lastTouchPos={pageX:b.pageX,pageY:b.pageY}):(a.pageX||0===a.pageX||a.clientX||0===a.clientX)&&(b.pageX=a.pageX||a.clientX+document.body.offsetLeft,b.pageY=a.pageY||a.clientY+document.body.offsetTop),(e.indexOf("key")>-1||a.keyCode||a.charCode)&&(b.keyCode=a.keyCode||a.which,b.charCode=a.keyCode||a.charCode||a.which,b.which=a.which),(e.indexOf("mouse")>-1||e.indexOf("click")>-1||null!==a.button&&void 0!==a.button)&&(b.button="number"==typeof a.button?a.button:a.which),b.target&&3===b.target.nodeType&&3!==f.nodeType&&(b.target=b.target.parentNode),h.searchNode=b.relatedTarget||b.target;do if(h.searchNode===f){h.isInSelf=!0;break}while(h.searchNode&&(h.searchNode=h.searchNode.parentNode)&&h.searchNode!==document);if("mouseover"!==e&&"mouseout"!==e||!h.isInSelf){if(d&&d.call&&(h.handlerResponse=d.call(f,b)),b.returnValue=h.handlerResponse!==!1&&b.returnValue!==!1,b.defaultPrevented&&(b.returnValue=a.returnValue=!1,a.preventDefault&&a.preventDefault()),b.bubblingCancelled===!0||b.propagationStopped===!0||b.cancelBubble===!0){a.stopPropagation&&a.stopPropagation();try{a.cancelBubble&&a.cancelBubble.call?a.cancelBubble():a.cancelBubble=!0}catch(i){}}h.ret=b.returnValue}else h.ret=!0;return h.end()}};return d.wrappedHandler.displayName="wrappedEventHandler_"+a,d.wrappedHandler.handler=b,d.wrappedHandler.type=a,d.wrappedHandler.target=d.target,this.list.push(d),c=a=b=d=null,this.list[this.list.length-1].wrappedHandler}},k.getSubjectDescription=function(a){return(a.nodeName?g.el(a)+"":a.constructor&&a.constructor.name||a.name||a)+""},g.eventTypeMap={},k.support.webkitMultitouch&&g.extend(g.eventTypeMap,{mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"}),g.addEvent=function(a,b,c,d){var e,f;if(a){if("string"===g.typeOf(b)&&b.indexOf(",")>-1&&(b=b.replace(/\s/gm,"").split(",")),g.isArray(b)){for(e=0;e<b.length;e++)g.addEvent(a,b[e],c);return!0}if(f=b=(b+"").toLowerCase().replace(/^\s*(on)?(.*?)\s*$/gim,"$2"),"string"!=typeof b||!c||!c.call)return g.log("Attempted to add event with invalid type or handler:",{type:b,handler:c+"",subject:k.getSubjectDescription(a),useCapture:d===!0}),void 0;g.eventTypeMap.hasOwnProperty(b)&&(b=g.eventTypeMap[b]),c=k.wrappedEventListener.create(f,c,a),a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&(a.addEventListener(b,c,d===!0),g._eventCount=(g._eventCount||0)+1)}},g.removeEvent=function(a,b,c,d){var e,f;if(a){if("string"===g.typeOf(b)&&b.indexOf(",")>-1&&(b=b.replace(/\s/gm,"").split(",")),g.isArray(b)){for(e=0;e<b.length;e++)g.removeEvent(a,b[e],c,d);return!0}if(f=b=(b+"").toLowerCase().replace(/^\s*(on)?(.*?)\s*$/gim,"$2"),"string"!=typeof b||!c||!c.call)return g.log("Attempted to remove event with invalid type or handler:",{type:b,handler:c+"",subject:k.getSubjectDescription(a),useCapture:d===!0}),void 0;if(g.eventTypeMap.hasOwnProperty(b)&&(b=g.eventTypeMap[b]),c=k.wrappedEventListener.get(f,c,a,!0),a.detachEvent)a.detachEvent("on"+b,c);else if(a.removeEventListener)try{a.removeEventListener(b,c,d===!0),g._eventCount=(g._eventCount||0)-1}catch(h){}}},g.cancelEvent=function(a){if(a=a||window.event){a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation();try{a.cancelBubble=!0}catch(b){}a.returnValue=!1}return!1},g.fireEvent=function(a){var b,c,d,e,f;if(a=a||{},document.createEventObject){a=g.extend({},a),a.type="on"+a.type.toLowerCase().replace(/^on/,"");try{b=document.createEventObject()}catch(h){f=!0}if(!f){for(d in a)if(a.hasOwnProperty(d))try{b[d]=a[d]}catch(h){}try{c=a.target.fireEvent(a.type,b),e=b.preventDefault===!0}catch(h){f=!0}}f&&k.wrappedEventListener.internalFireEvent&&k.wrappedEventListener.internalFireEvent(a)}else{b=document.createEvent("HTMLEvents"),b.initEvent(a.type.toLowerCase().replace(/^on/,""),!0,!0);for(d in a)if(a.hasOwnProperty(d))try{b[d]=a[d]}catch(h){}c=!a.target.dispatchEvent(b),e=b.preventDefault===!0}return{evt:b,preventDefault:e,rval:c}},k._nodeToIdIndex=0,k._nodeToIdList={},k.nodeToId=function(a){var b,c;return a===window?"_td_autoid_window":a===document.documentElement?"_td_autoid_html":a===document.body?"_td_autoid_body":(b=/\s_td_autoid_([0-9]+)\s/gm.exec(" "+a.className+" "),b&&b[1]?c=b[1]:(k._nodeToIdIndex+=1,c=k._nodeToIdIndex+"",g.addClass(a,"_td_autoid_"+c)),k.ensureNodeIdListing(a,c),c)},k.idToNode=function(a){var b,c,d=k._nodeToIdList[a+""];return"_td_autoid_window"===a?window:"_td_autoid_html"===a?document.documentElement:"_td_autoid_body"===a?document.body:(d&&(c=g.getElement(d),/\s_td_autoid_[0-9]+\s/gm.exec(" "+c.className+" ")||(c=null)),c||(b=g.getElement("._td_autoid_"+a),c=b&&b[0],c&&k.ensureNodeIdListing(c,a)),c||!1)},k.ensureNodeIdListing=function(a,b){var c;a.getAttribute&&(c=a.getAttribute("id"),c||(c="_td_autoid_"+b,a.setAttribute("id",c)),k._nodeToIdList[b]="#"+c)},k.removeNodeUID=function(a){var b=a.getAttribute("id");b&&b.match(/^_td_autoid_[0-9]+$/g)&&(a.removeAttribute?a.removeAttribute("id"):a.setAttribute("id","")),a.className&&(a.className=a.className.replace(/(^|\b)_td_autoid_[0-9]+(\b|$)/gim,""))},g.animationFrame=function(a){var b={manualFramerate:11};return window.mozRequestAnimationFrame?a="moz":window.webkitRequestAnimationFrame&&(a="webkit"),b.nativeSupport=!!a,b.nativeSupport?(b.getTimer=function(b){return window[a+"RequestAnimationFrame"](b)},b.cancelTimer=function(b){window[a+"CancelRequestAnimationFrame"](b)},b.getStartTime=function(){return window[a+"AnimationStartTime"]||(new Date).getTime()}):(b.getTimer=function(a){return setTimeout(function(){a((new Date).getTime()),a=null},b.manualFramerate)},b.cancelTimer=function(a){clearTimeout(a)},b.getStartTime=function(){return(new Date).getTime()}),b}(),g.setOpacity=function(a,b){1>=b&&b>0&&(b=100*b),b=Math.round(b),100>b?(a.style.opacity=parseFloat(b/100).toFixed(2),a.style.filter="alpha(opacity="+b+")"):(a.style.opacity=null,a.style.filter=null)},g.applyMsFilter=function(a,b,c){var d,e,f,h,i,j="",l="MsFilter"===k.support.filterProperty?'"':"";if(b=b.charAt(0).toUpperCase()+b.substring(1),"string"==typeof c)for(j=c,c={},h=j.replace(/\s*(,|=)\s*      /gm,"$1").split(","),f=0;f<h.length;f++)i=h[f].indexOf("="),c[h[f].substring(0,i)]=h[f].substring(i+1);else{for(f in c)c.hasOwnProperty(f)&&(j+=", "+f+"="+c[f]);j=j.replace(",","")}try{d=a.filters&&a.filters.item&&(a.filters.item("DXImageTransform.Microsoft."+b)||a.filters.item(b))}catch(m){}if(d){for(f in c)c.hasOwnProperty(f)&&"enabled"!==f&&(d[f]=c[f]);d.enabled=c.enabled?1:0}else e=a.style.MsFilter||a.style.filter||"",e+=" "+(g.nodeStyle(a,"MsFilter")||g.nodeStyle(a,"filter")||""),e&&(e=e.replace(new RegExp('(^|\\s|\\))"?((progid\\:)?DXImageTransform\\.Microsoft\\.)?'+b+'\\s*?\\(.*?\\)"?\\s*?',"gim"),"$1")+" "),a.style[k.support.filterProperty]=e+l+"progid:DXImageTransform.Microsoft."+b+"("+j+")"+l;a.style.zoom||(a.style.zoom=1)};var m={};g.applyCss=function(c,d){var e,f,h,i,j;d=d||{};for(e in d)if(d.hasOwnProperty(e))try{f=g.getStyleAsCSS(e),f=f.replace(/^\-(moz|webkit|ms|o|vendor)\-/gim,b+"-"),f=g.getStyleAsProperty(f),f=a(f),"opacity"===f&&k.support.filters?(j=Math.round(100*parseFloat(d[e])),100>j?g.applyMsFilter(c,"alpha",{enabled:!0,opacity:j}):g.applyMsFilter(c,"alpha",{enabled:!1})):"--box-shadow"===f&&k.support.filters?(h=d[e].match(/\b(\#[0-9af]{3}[0-9af]{3}?|rgba?\([0-9\,\s]+\))\b/gim),h=h&&h[0]||"",i=(" "+d[e]+" ").replace(h,"").replace(/\s+/m," ").split(" ").slice(1,4),g.applyMsFilter(c,"glow",{Color:h,Strength:Math.round(i[3].replace(/[^0-9\-\.]/gim,""))})):c.style[f]=d[e]}catch(l){}},g.getStyleAsProperty=function(a){return"string"!=typeof a?null:(a=a.replace(/\-[a-z0-9]/gim,k.styleAsPropReplacer),a=a.replace(/^(webkit|moz|ms|o)[A-Z]/gm,k.styleAsPropVendorPrefixReplacer))},k.styleAsPropReplacer=function(a){return a.charAt(1).toUpperCase()},k.styleAsPropVendorPrefixReplacer=function(a){return a.charAt(0).toUpperCase()+a.substring(1)},g.getStyleAsCSS=function(a){return"string"==typeof a&&a.replace(/\-*([A-Z])/gm,"-$1").toLowerCase()||null},k.parseCSS=function(a){var b,c,d=/\s*([a-z\-]+)\s*:\s*([^;]*?)\s*(?:;|$)/gi;if(a)for(b={},d.lastIndex=0;c=d.exec(a);)b[g.getStyleAsProperty(c[1])]=c[2];return b},g.getCssTransitions=function(a){var b,c,d,e,f={},h={properties:"-vendor-transition-property",durations:"-vendor-transition-duration",timingFunctions:"-vendor-transition-timing-function"};for(b in h)h.hasOwnProperty(b)&&(h[b]=(g.nodeStyle(a,h[b])||"").replace(/\s/,"").split(","));for(c=0;c<h.properties.length;c++)!h.properties[c]||"null"===h.properties[c]||"all"===h.properties[c]&&h.durations[c].match(/^[0\.ms]*$/)||(d=h.durations[c]||h.durations[h.durations.length-1],e=parseFloat(d.replace(/[^\-0-9\.]/gim,""))||0,d.match(/ms$/i)||(e*=1e3),f[g.getStyleAsProperty(h.properties[c])]={duration:e,timingFunction:h.timingFunctions[c]||h.timingFunctions[h.timingFunctions.length-1]||"ease"});return f},g.setCssTransitions=function(a,b){var c,d={"-vendor-transition-property":[],"-vendor-transition-duration":[],"-vendor-transition-timing-function":[]};for(c in b)b.hasOwnProperty(c)&&b[c]&&(d["-vendor-transition-property"].push(c.toLowerCase()),d["-vendor-transition-duration"].push((b[c].duration/1e3).toFixed(3)+"s"),d["-vendor-transition-timing-function"].push(b[c].timingFunction||"ease"));for(c in d)d.hasOwnProperty(c)&&(d[c]=d[c].join(", "));g.applyCss(a,d)},g.updateCssTransitions=function(a,b){var c,d;if(b){c=g.getCssTransitions(a);for(d in b)b.hasOwnProperty(d)&&(b[d]?c[d]=b[d]:delete c[d]);g.setCssTransitions(a,c)}},g.addClass=function(a,b){var c,d;if(b){if(g.isArray(b)||(b=[b]),c=a.className||"",c.length>0){for(c=" "+c+" ",d=0;d<b.length;d++)for(;c.indexOf(" "+b[d]+" ")>-1;)c=c.replace(" "+b[d]+" "," ");c=c.substring(1)}a.className=(c+b.join(" ")).replace(/\s+/gim," ")}},g.removeClass=function(a,b){var c,d;if(b){if(g.isArray(b)||(b=[b]),c=a.className||"",c.length>0){for(c=" "+c+" ",d=0;d<b.length;d++)for(;c.indexOf(" "+b[d]+" ")>-1;)c=c.replace(" "+b[d]+" "," ");c=c.substring(1)}a.className=c.replace(/\s+/gim," ")}},g.nodeStyle=function(a,c){var d,e,f,g=(c+"").replace(/[A-Z]/g,"-$0").toLowerCase();return g=g.replace(/^\-(moz|webkit|ms|o|vendor)\-/gim,b+"-"),d=g.replace(/\-[a-z]/gim,function(a){return a.substring(1).toUpperCase()}),"opacity"===g&&k.support.filters?a.filters.alpha&&a.filters.alpha.enabled!==!1&&Math.round(a.filters.alpha.opacity)/100:(a.style&&a.style[d]?f=a.style[d]||"":a.currentStyle&&a.currentStyle[d]?f=a.currentStyle[d]||a.currentStyle[g]||"":document.defaultView&&document.defaultView.getComputedStyle?(e=document.defaultView.getComputedStyle(a,null),f=e&&(e.getPropertyValue(g)||e.getPropertyValue(d))||""):window.getComputedStyle&&(e=window.getComputedStyle(a,null),f=e&&(e.getPropertyValue(g)||e.getPropertyValue(d))||""),f)},g.htmlEntities=function(a,b){var c=["htmlEntities"];return b===!0&&c.push("stripTags"),g.text.filter(a,c)},g.log=function(){window.console&&window.console.log&&window.console.log.apply(window.console,arguments)},g.addNodeSelectionPlugin=function(a,b){g.NodeSelection.prototype.hasOwnProperty(a)||(g.NodeSelection.prototype[a]=function(){var a=b.apply(this,arguments);return null===a||void 0===a?this:a})},g.init=function(){i||(i=!0,g.forEach(k.oninit,function(a){a.call(g,g)}),g.fireEvent({target:document.body,type:"puredomready",puredom:g}))},g.addEvent(document,"DOMContentLoaded",g.init),g.addEvent(window,"load",g.init),g.addEvent(window,"unload",k.unload),function(){if(f){for(var a in f)f.hasOwnProperty(a)&&(g[a]=f[a]);f=null}}(),k.puredom=function(a){return"function"===g.typeOf(a)?(i===!0?a.call(g,g):k.oninit.push(a),g):g.el.apply(g,arguments)},g.extend(g,h),g.toString=function(){return"function puredom(){}"},window.puredom=g,"function"==typeof window.define&&window.define.amd&&window.define("puredom",function(){return g})}(),puredom.extend(puredom,{text:function(){var a=function(){return a.filter.apply(this,arguments)},b={htmlEntities:/[&<>"]/gim,ucWords:/(^|\s)[a-z]/gim,ucFirst:/^[a-z]/gim,nl2br:/\r?\n/g,numbersOnly:/[^0-9.\-]/gim,trim:/^\s*?(.*?)\s*?$/gim};return a.filter=function(b,c){var d,e,f,g,h;if("array"!==puredom.typeOf(c)&&(c=((c||"")+"").split("|")),arguments.length>2)for(d=2;d<arguments.length;d++)"array"===puredom.typeOf(arguments[d])?c=c.concat(arguments[d]):c.push(arguments[d]);for(d=0;d<c.length;d++){e=c[d],g=[b],f=e.indexOf(":"),f>-1&&(e=e.substring(0,f),g=g.concat(c[d].substring(f+1).split(",")));for(h in a)if((h+"").toLowerCase()===e.toLowerCase()){b=a[h].apply(a,g);break}}return b},a.escape=function(a){return encodeURIComponent(a)},a.unescape=function(a){return decodeURIComponent(a)},a.htmlEntities=function(a){var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};return(a+"").replace(b.htmlEntities,function(a){return c[a]})},a.ucWords=function(a){return(a+"").toLowerCase().replace(b.ucWords,function(a){return a.toUpperCase()})},a.ucFirst=function(a){return(a+"").toLowerCase().replace(b.ucFirst,function(a){return a.toUpperCase()})},a.nl2br=function(a){return(a+"").replace(b.nl2br,"<br />")},a.numbersOnly=function(a){return(a+"").replace(b.numbersOnly,"")},a.truncate=function(a,b,c,d){var e=!1,f=a+"";return a=f,b=parseInt(b,10)||80,c=c===!0||"true"===c||"byWord"===c,d=d||"...",a.length>b&&(c?(a=a.substring(0,b),f.charAt(b).match(/\s/)||(a=a.replace(/\s[^\s]*$/,""))):a=a.substring(0,b-d.length),e=!0),e&&(a+=d),a},a.trim=function(a){var b,c=/\s/;for(a=a.replace(/^\s\s*/,""),b=a.length;c.test(a.charAt(--b)););return a.slice(0,b+1)},a["default"]=function(b,c){return b=a.trim(b),b?b:c},a.dateformat=function(a,b){var c,d=puredom.i18n,e=puredom.date;return e&&e.create&&(c=e.create(a)),(!c||(c+"").indexOf("Invalid")>-1)&&(c=new Date(a),(!c||(c+"").indexOf("Invalid")>-1)&&(c=new Date,c.setTime(Math.round(a)))),b&&b.indexOf("%")>-1?e&&e.format&&(a=e.format(c,b)):d&&(a=d(c,null,null,{datetype:b||"date"})||c+""),a},a}(),parameterize:function(a,b){var c,d,e,f,g=[],h=puredom.extend({delimiter:"&",startDelimiter:"?",assignment:"=",typeHandlers:null},b);for(c in a)if(a.hasOwnProperty(c))if(d=a[c],f=this.typeOf(d),h.typeHandlers&&h.typeHandlers.hasOwnProperty(f))g.push(h.delimiter+encodeURIComponent(c)+"="+encodeURIComponent(h.typeHandlers[f](d)));else if("array"===f&&h.disableArrayParams!==!0)for(e=0;e<d.length;e++)g.push(h.delimiter+encodeURIComponent(c)+"[]="+encodeURIComponent(d[e]));else{switch(f){case"boolean":d=d?"true":"false";break;case"null":case"undefined":d="";break;case"object":d=h.useJsonForObjects!==!1?this.json(d):this.parameterize(d)}g.push(encodeURIComponent(c)+"="+encodeURIComponent(d))}return g=g.join(h.delimiter||"&"),g=(h.startDelimiter||"")+g},querystring:{parse:function(a){var b,c,d,e={};for("?"===a.substring(0,1)&&(a=a.substring(1)),b=a.split("&"),c=0;c<b.length;c++)b[c]&&(d=b[c].indexOf("="),e[decodeURIComponent(b[c].substring(0,d))]=0>d?"":decodeURIComponent(b[c].substring(d+1)));return e},stringify:function(a,b){return b=puredom.extend({startDelimiter:""},b||{}),puredom.parameterize(a,b)},build:function(){return puredom.querystring.stringify.apply(puredom.querystring,arguments)}},cookies:function(){var a={};return{set:function(b,c,d,e,f,g){var h,i="",j="";f="string"==typeof f?f:"",d&&(h=new Date,h.setTime(h.getTime()+1e3*60*60*24*d),i="; expires="+h.toGMTString()),a.hasOwnProperty(b)&&a[b].expires&&(i="; expires="+a[b].expires.toGMTString()),j=b+"="+encodeURIComponent(c)+i+"; path=/"+f.replace(/^\//,""),"string"==typeof e&&e.length>0&&(j+="; domain="+e.replace(/[\;\,]/,"")),g===!0&&(j+="; secure"),document.cookie=j,a[b]={value:c,expires:h}},get:function(b,c){if(a.hasOwnProperty(b)&&c!==!0)return a[b].value;var d,e,f=document.cookie.split(";");for(e=0;e<f.length;e++)if(d=f[e].replace(/^\s+/gim,""),0===d.indexOf(b+"="))return decodeURIComponent(d.substring(b.length+1,d.length));return null},remove:function(b){this.set(b,"",-1),delete a[b]},purge:function(){for(var b in a)a.hasOwnProperty(b)&&(this.remove(b),delete a[b])},read:function(){return this.get.apply(this,arguments)},write:function(){return this.set.apply(this,arguments)}}}(),Cache:function(){function a(){return this.constructor!==arguments.callee&&this.constructor!==a?new a:(this.data={},void 0)}return puredom.extend(a.prototype,{defaultType:"_default",purge:function(){this.data={}},get:function(a,b,c){var d;return 2===arguments.length&&(b=a,c=b,a=null),a=(a||this.defaultType)+"",b+="",d=this.data.hasOwnProperty(a)&&this.data[a][b]||!1,c?(d&&c(d),!!d):d},set:function(a,b,c){2===arguments.length&&(b=a,c=b,a=null),a=(a||this.defaultType)+"",b+="",this.data[a]||(this.data[a]={}),this.data[a][b]=c},proxySet:function(a,b,c,d){var e=this;return function(){e.set(a,b,arguments[d||0]),c&&c.apply(c,arguments)}},each:function(a){return puredom.foreach(this.data,a)}}),a}(),json:function(){var a=function(b){return"string"===puredom.typeOf(b)?a.parse(b):a.stringify(b)};return a.stringify=function(a){var b;try{b=JSON.stringify(a)}catch(c){puredom.log("puredom.json:: Stringify failed: "+c+" | "+a)}return b},a.parse=function(a){var b;if("string"==typeof a&&a.length>0)try{b=JSON.parse(a)}catch(c){puredom.log("puredom.json:: Parse failed: "+c+" | "+a)}return b},a.serialize=a.stringify,a.unserialize=a.parse,a}(),xml:{parse:function(a){var b;return window.DOMParser?b=(new window.DOMParser).parseFromString(a,"text/xml"):(b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)),b}}}),puredom.EventEmitter=function(){this._eventRegistry=[]},puredom.EventEmitter.prototype.addEventListener=function(a,b){var c,d;if(a=(a+"").toLowerCase().replace(/\s+/gim,""),a.indexOf(",")>-1){for(c=a.split(","),d=0;d<c.length;d++)this.addEventListener(c[d],b);return this}return a=a.replace(/^on/,""),this._eventRegistry.push({type:a,handler:b}),this},puredom.EventEmitter.prototype.addListener=puredom.EventEmitter.prototype.addEventListener,puredom.EventEmitter.prototype.on=puredom.EventEmitter.prototype.addEventListener,puredom.EventEmitter.prototype.removeEventListener=function(a,b){var c,d,e,f;if(a=(a+"").toLowerCase().replace(/\s+/gim,""),a.indexOf(",")>-1){for(e=a.split(","),f=0;f<e.length;f++)this.removeEventListener(e[f],b);return this}for(a=a.replace(/^on/,""),c=this._eventRegistry.length;c--;)if(d=this._eventRegistry[c],d.type===a&&d.handler===b){this._eventRegistry.splice(c,1);break}return this},puredom.EventEmitter.prototype.removeListener=puredom.EventEmitter.prototype.removeEventListener,puredom.EventEmitter.prototype.fireEvent=function(a,b){var c,d,e,f=[],g=[];for(a=(a+"").toLowerCase().replace(/^on/,""),puredom.isArray(b)||(b=[b]),c=this._eventRegistry.length;c--&&(d=this._eventRegistry[c],d.type!==a||(0===g.length&&(g.falsy=g.falsey=g.truthy=!0),e=d.handler.apply(this,b),g.push(e),e===!0?g.falsy=g.falsey=!1:e===!1&&(g.truthy=!1),e!==!1)););return f=null,g},puredom.EventEmitter.prototype._fireEvent=puredom.EventEmitter.prototype.fireEvent,puredom.ControllerManager=function(a){puredom.EventEmitter.call(this),this.controllerOptions=puredom.extend({},this.controllerOptions),this._messageListeners=[],this._controllers=[],this._current=null,a&&(a.controllerOptions&&puredom.extend(this.controllerOptions,a.controllerOptions),"boolean"===puredom.typeOf(a.singular)&&(this.singular=a.singular),"boolean"===puredom.typeOf(a.allowLoadDefault)&&(this.allowLoadDefault=a.allowLoadDefault))},puredom.extend(puredom.ControllerManager.prototype,{controllerOptions:{},restoreState:function(a){this.initialized!==!0?this._initState=a:a&&a.current?this.load(a.current):this.loadDefault()},doStateUpdate:function(a,b){this.updateState&&this.updateState(a,b)},init:function(a){var b=!0;if(this.initialized!==!0){this.initialized=!0,a&&(a.controllerOptions&&puredom.extend(this.controllerOptions,a.controllerOptions),"boolean"===puredom.typeOf(a.singular)&&(this.singular=a.singular),"boolean"===puredom.typeOf(a.allowLoadDefault)&&(this.allowLoadDefault=a.allowLoadDefault),a.autoRestoreOnInit===!1&&(b=!1)),this._initState&&b&&this.restoreState(this._initState),this._initState=null;try{delete this._initState}catch(c){}this.allowLoadDefault===!1||this.current()||this.loadDefault()}},destroy:function(){var a,b;try{for(a=this.current(),a&&a.unload&&a.unload(),b=this._controllers.length;b--;)this._controllers[b].destroy&&this._controllers[b].destroy()}catch(c){}this.controllerOptions={},this._controllers=[],this._messageListeners=[],this._current=null},register:function(a,b){b=b||{},"string"===puredom.typeOf(a)?b.name=a:b=a,this._controllers.push(b),this._fireEvent("add",[this.getIdFromName(b.name)])},load:function(a,b){var c,d,e,f,g,h,i,j;if(a=(a+"").toLowerCase(),d=this.singular===!0&&this.current(),d&&d.name.toLowerCase()===a)return d.handleRepeatLoad&&d.handleRepeatLoad(b||{}),!0;if(c=this._createControllerSandbox(a),e=puredom.extend({previousController:d},this.controllerOptions||{},b||{},c.sandbox),f=a&&this.get(a)){if(puredom.extend(f,c.sandbox),this.singular===!0&&(j=this._unloadCurrent(),j===!1))return!1;if(h=f,f.load){if(g=this._fireEvent("beforeload",[f.name]),g===!1||g.falsey&&!g.truthy)return!1;i=f.load(e),null!==i&&void 0!==i&&(h=i)}if(i===!1){if(g=this._fireEvent("loadcancel",[f.name]),g===!1||g.falsey&&!g.truthy)return!1;this.singular===!0&&e.previousController?this.load(e.previousController.name,b):this.loadDefault(b)}else this._current=this.getIdFromName(a),this._fireEvent("load",[a]),this._fireEvent("change",[a]),this.doStateUpdate({current:a});return h}return!1},loadDefault:function(a){for(var b=this._controllers.length;b--;)if(this._controllers[b].isDefault===!0)return this.load(this._controllers[b].name,a);return!1},loadPrevious:function(a){this._previousController&&this.load(this._previousController,a)},none:function(){this._unloadCurrent()},reloadCurrent:function(){var a=this.current();a&&(this._unloadCurrent(),this.load(a.name,this.controllerOptions))},_unloadCurrent:function(){var a,b=this.current();if(b&&b.unload){if(a=this._fireEvent("beforeunload",[b.name]),a===!1||a.falsey&&!a.truthy)return!1;if(a=b.unload(),a===!1)return!1;this._fireEvent("unload",[b.name]),this._current=null}},get:function(a,b){a=(a+"").toLowerCase();for(var c=this._controllers.length;c--;)if(this._controllers[c].name.toLowerCase()===a)return b===!0?c:this._controllers[c];return!1},postMessage:function(a,b){var c=this.current();return c&&c.onmessage?(c.onmessage(a,b),!0):!1},onMessage:function(a,b,c){var d={type:(a+"").toLowerCase().replace(/^on/gim,""),handler:b};c&&("string"===puredom.typeOf(c)?d.controller=c.toLowerCase():c.hasOwnProperty("name")&&(d.controller=(c.name+"").toLowerCase())),this._messageListeners.push(d)},getList:function(a){var b,c,d,e=[];for(a=a||[],b=0;b<this._controllers.length;b++){for(d={name:this._controllers[b].name},c=0;c<a.length;c++)d[a[c]]=this._controllers[b][a[c]];e.push(d)}return e},current:function(){return"number"===puredom.typeOf(this._current)&&this._controllers[this._current]||!1},getIdFromName:function(a){return this.get(a,!0)},getNameFromId:function(a){var b="number"===puredom.typeOf(a)&&this._controllers[a];return b&&b.name||!1},_createControllerSandbox:function(a){var b,c,d,e=this,f=!1;return a=(a+"").toLowerCase(),d=function(a,b){var c=new Error("Listener error encountered in ControllerManager#sandbox.postMessage() :: "+b.message,b.fileName,b.lineNumber);setTimeout(function(){var d=c;throw b=c=a=null,d},1)},b={controllerManager:e,manager:e,postMessage:function(b,c){var d,g;if(c=puredom.extend({},c,{controller:a,type:(b+"").replace(/^on/gim,"")}),!f)for(e._fireEvent("message",c),e._fireEvent(c.type,c),g=0;g<e._messageListeners.length;g++)if(d=e._messageListeners[g],!d.controller||d.controller===a.toLowerCase())try{d.handler(c)}catch(h){throwListnerError(d,h)}}},c={setName:function(b){a=(b+"").toLowerCase()},mute:function(){f=!0},unmute:function(){f=!1},destroy:function(){for(var a in this.sandbox)this.sandbox.hasOwnProperty(a)&&(this.sandbox[a]=null);delete this.sandbox,e=null},sandbox:b},setTimeout(function(){c=b=null},1),c},_postMessageFromController:function(){},_controllers:[],_messageListeners:[],_current:null}),puredom.inherits(puredom.ControllerManager,puredom.EventEmitter),puredom.LocalStorage=function(a,b,c){var d=this;"function"==typeof arguments[2]&&(b=arguments[2],c=arguments[1]),c=c||{},this.id=a,this.adapter=null,this.data={},c.adapter&&this.setAdapter(c.adapter),this.adapter||c.useBest===!1||this.useBestAdapter(),this.adapter&&c.restore!==!1?this.restore(function(){b&&b(d),d=c=null}):b&&(b(d),d=null)},puredom.LocalStorage.prototype.commitDelay=100,puredom.LocalStorage.prototype.data={},puredom.LocalStorage.prototype.setAdapter=function(a){var b,c=this.constructor.adapters,d=(a+"").toLowerCase(),e=!1,f=!1;for(b in c)if(c.hasOwnProperty(b)&&(b+"").toLowerCase()===d&&(e=!0,c[b].test(this)===!0)){f=!0,this.adapterName=a,this.adapter=c[b];break}return e?f?!0:(puredom.log('puredom.LocalStorage :: "'+a+'" adapter test() failed: conditions for adapter use not met.'),!1):(puredom.log('puredom.LocalStorage :: Could not find "'+a+'" adapter.'),!1)},puredom.LocalStorage.prototype.getAdapter=function(){return this.adapterName},puredom.LocalStorage.prototype.useBestAdapter=function(){var a,b,c,d=this.constructor.adapters;for(c in d)d.hasOwnProperty(c)&&"none"!==c&&d[c].test(this)===!0&&(!a||(Math.round(a.rating)||0)<(Math.round(d[c].rating)||0))&&(a=d[c],b=c);return a?(this.adapterName=b,this.adapter=a,!0):(setTimeout(function(){throw"puredom.LocalStorage :: Could not find the best adapter."},1),!1)},puredom.LocalStorage.prototype.getNamespace=function(a){var b,c=this;return a+="","."===a.substring(0,1)&&(a=a.substring(1)),"."===a.substring(a.length-1)&&(a=a.substring(0,a.length-1)),b=puredom.extend(new puredom.LocalStorage.NamespacedLocalStorage,{getAdapter:function(){return c.getAdapter()},getNamespace:this.getNamespace,getValue:function(b){return c.getValue(a+"."+b)},setValue:function(b,d){return c.setValue(a+"."+b,d),this
},removeKey:function(b){return c.removeKey(a+"."+b),this},purge:function(){return c.removeKey(a),this},getData:function(){return c.getValue(a)},restore:function(a){var b,d=this;return a&&(b=function(){a(d),d=b=a=null}),c.restore(b),this},commit:function(a){var b,d=this;return a&&(b=function(){a(d),d=b=a=null}),c.commit(b),this}}),puredom.extend(b,{get:b.getValue,set:b.setValue,remove:b.removeKey}),b},puredom.LocalStorage.prototype.getData=function(){return this.data},puredom.LocalStorage.prototype.getValue=function(a){var b=puredom.delve(this.data,a);return b},puredom.LocalStorage.prototype.setValue=function(a,b){var c,d=this.data,e=a.split(".");for(c=0;c<e.length-1;c++)d.hasOwnProperty(e[c])||(d[e[c]]={}),d=d[e[c]];return void 0===b||null===b?(d[e[e.length-1]]=null,delete d[e[e.length-1]]):d[e[e.length-1]]=b,this.queueCommit(),this},puredom.LocalStorage.prototype.removeKey=function(a){return this.setValue(a,void 0),this},puredom.LocalStorage.prototype.get=puredom.LocalStorage.prototype.getValue,puredom.LocalStorage.prototype.set=puredom.LocalStorage.prototype.setValue,puredom.LocalStorage.prototype.remove=puredom.LocalStorage.prototype.removeKey,puredom.LocalStorage.prototype.purge=function(){return this.data={},this.queueCommit(),this},puredom.LocalStorage.prototype.restore=function(a){var b,c,d=this;return b=this._adapterCall("load",function(b){d.data=c=b||{},a&&a(d),d=null}),b&&!c&&(this.data=b,a&&a(this)),b=c=null,this},puredom.LocalStorage.prototype.commit=function(a){var b=this;return this._commitTimer&&(clearTimeout(this._commitTimer),this._commitTimer=null),this._adapterCall("save",this.data,function(){a&&a(b),b=null}),this},puredom.LocalStorage.prototype.queueCommit=function(){var a=this;this._commitTimer||(this._commitTimer=setTimeout(function(){a.commit(),a=null},this.commitDelay))},puredom.LocalStorage.prototype._adapterCall=function(a){return this.adapter&&this.adapter[a]?this.adapter[a].apply(this.adapter,[this].concat(puredom.toArray(arguments).slice(1))):void 0},puredom.LocalStorage.NamespacedLocalStorage=function(){},puredom.LocalStorage.adapters={},puredom.LocalStorage.addAdapter=function(a,b){if(!b.save)throw'puredom.LocalStorage :: Adapter "'+a+'" attempted to register, but does not provide a save() method.';if(!b.load)throw'puredom.LocalStorage :: Adapter "'+a+'" attempted to register, but does not provide a load() method.';this.adapters[a]=b},puredom.LocalStorage.adapters.none=function(){},puredom.extend(puredom.LocalStorage.adapters.none.prototype,{defaultName:"db",rating:0,test:function(){return!1},load:function(a,b){b&&b()},save:function(a,b,c){c&&c(!1)}}),this.JSON||(this.JSON={}),function(){function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)d=rep[c],"string"==typeof d&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),puredom.LocalStorage.addAdapter("cookie",{defaultName:"db",rating:5,test:function(){return puredom.cookies&&puredom.cookies.get&&"cookie"in document?!0:!1},load:function(a,b){var c,d=puredom.cookies.get(a.id||this.defaultName);return d&&(c=puredom.json(d)),b&&b(c),c},save:function(a,b,c){puredom.cookies.set(a.id||this.defaultName,puredom.json(b)),c&&c(!0)}}),puredom.LocalStorage.addAdapter("LocalStorage",{defaultName:"db",rating:60,test:function(){var a,b="localStorage"in window&&"function"==typeof window.localStorage.hasOwnProperty,c=puredom.json({a:"a",b:4/3,c:!0,d:null});if(b)try{a=localStorage.__test,localStorage.__test=c,localStorage.__test!==c&&(b=!1),localStorage.__test=a,void 0===a&&delete localStorage.__test}catch(d){b=!1}return b},load:function(a,b){var c,d=this._getKey(a);return localStorage.hasOwnProperty(d)&&(c=puredom.json.parse(localStorage[d])),b&&b(c),c},save:function(a,b,c){var d=this._getKey(a);return void 0===b?delete localStorage[d]:localStorage[d]=puredom.json.stringify(b),c&&c(!0),!0},_getKey:function(a){return(a.id||this.defaultName||"")+""}}),puredom.LocalStorage.addAdapter("UserData",{defaultName:"db",rating:20,test:function(){return/\bMSIE\s[1-6](\.[0-9]*)?/gim.test(navigator.userAgent+"")?!1:"undefined"!=typeof document.body.addBehavior},load:function(a,b){var c,d,e=this._getKey(a),f=this._getStore(e);return f&&(c=f.getAttribute("puredomlocalstorage")),c&&(d=puredom.json.parse(c)),b&&b(d),d},save:function(a,b,c){var d=this._getKey(a),e=this._getStore(d),f="puredomlocalstorage",g=!1;return e&&"save"in e&&(void 0===b?e.removeAttribute?e.removeAttribute(f):e.setAttribute(f,""):e.setAttribute(f,puredom.json.stringify(b)),e.save(d),g=!0),c&&c(g),g},_getStore:function(a){var b;return this.stores||(this.stores={}),b=this.stores[a],b||(b=this.stores[a]=document.getElementById(a),b||(b=this.stores[a]=document.createElement("span"),b.style.position="absolute",b.style.top="-100px",b.style.left="0",b.style.behavior="url('#default#userData')",document.body.appendChild(b))),"true"!==b.getAttribute("data-tdlsud-loaded")&&(b.setAttribute("data-tdlsud-loaded","true"),b.load(a)),b},_getKey:function(a){return"ieud"+(a.id||this.defaultName||"")}}),puredom.LocalStorage.addAdapter("WebkitSQLite",{defaultName:"db",dbInfo:{name:"PuredomLocalStorage",table:"storage",version:"1.0",displayName:"Cache, Settings and Storage",quota:2e5,minimumQuota:1e4},rating:80,test:function(){return!!window.openDatabase},load:function(a,b){var c,d=this._getDatabase(a),e=this._getKey(a),f=this.dbInfo.table;b=b||this._nullCallback,d&&(c=function(a){a.message.indexOf("no such table")>-1?b():puredom.log("WebkitSQLite Adapter Error (load): "+a.message)},d.transaction(function(a){a?a.executeSql("SELECT key,value FROM "+f+" WHERE key=?",[e],function(a,c){var d=[];if(c&&c.rows)for(var e=0;e<c.rows.length;e++)d.push(c.rows.item(e));d.length>0?b(puredom.json.parse(d[0].value)):b()}):b(!1)},c))},save:function(a,b,c){var d=this._getKey(a),e=this.dbInfo.table;c=c||this._nullCallback,this._requireDatabase(a,function(f){var g,h,i=1;f?(g=function(a){puredom.log("WebkitSQLite Adapter Error (save): "+a.message)},h=function(){i-=1,0>=i&&(c&&c(!0),c=a=b=g=h=f=null)},b=puredom.json.stringify(b),f.transaction(function(a){a.executeSql("INSERT OR REPLACE INTO "+e+" (key,value) VALUES(?,?)",[d,b],h)},g)):(c(!1),c=null)})},_getDatabase:function(){var a,b=this.dbInfo.quota;if(this._currentDb)return this._currentDb;for(;!a&&b>this.dbInfo.minimumQuota;){try{a=openDatabase(this.dbInfo.name,this.dbInfo.version,this.dbInfo.displayName,b)}catch(c){}a||(b/=10)}return a?this._currentDb=a:puredom.log("LocalStorage ERROR: WebkitSQLite Adapter failed to open database."),a||!1},_requireDatabase:function(a,b){var c=this,d=this._getDatabase(a);this.dbInfo.table,b=b||this._nullCallback,d?c._createTable(d,function(){b(d),c=b=a=d=null}):(b(d,!1),c=b=a=null)},_createTable:function(a,b){var c=this.dbInfo.table;b=b||this._nullCallback,a?a.transaction(function(d){d.executeSql("CREATE TABLE IF NOT EXISTS "+c+" (key TEXT UNIQUE, value TEXT)",[],function(){b(!0),b=a=null},function(){b(!1)})}):b(!1)},_getKey:function(a){return(a.id||this.defaultName||"")+""},_nullCallback:function(){}}),puredom.date={now:Date.now?function(){return Date.now()}:function(){return+new Date},create:function(a){var b;return a?(a=(a+"").replace(/^([0-9]{4})\-([0-9]{2})\-([0-9]{2})T([0-9]{2})\:([0-9]{2})\:([0-9]{2})\.[0-9]{3}Z$/,"$1/$2/$3 $4:$5:$6"),b=new Date(a)):b=new Date,b},parse:function(a,b){function c(a,b){(b===!1||b===!0)&&(i.pm=b===!0),(a||0===a)&&(i.hours=a),a=i.hours,i.hours<12&&i.pm&&(a-=12);var c=h.getDate();12===i.hours&&i.pm===!1?(0!==h.getHours()||"boolean"==typeof b)&&h.setHours(0):(h.setHours(a),h.setDate(c))}function d(a){return f[1](a),""}b=b||"%d/%m/%Y";var e,f,g,h=new Date(0),i={},j={H:[/^[0-9]{1,2}/g,function(a){a=Math.round(a),c(a)}],I:[/^[0-9]{1,2}/g,function(a){a=Math.round(a),c(a)}],p:[/^[AP]M/gi,function(a){c(null,"pm"===a.toLowerCase())}],M:[/^[0-9]{1,2}/g,function(a){h.setMinutes(Math.round(a))}],a:[/^(Mon|Tue(s?)|Wed|Thu|Fri|Sat|Sun)/i,function(){}],A:[/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday)/i,function(){}],d:[/^[0-9]{1,2}/g,function(a){i.date=Math.round(a),h.setDate(i.date)}],m:[/^[0-9]{1,2}/g,function(a){i.month=Math.round(a)-1,h.setMonth(i.month)}],B:[new RegExp("^("+this.months.join("|")+")","gi"),function(a){i.month=date._getMonthIndex(a),h.setMonth(i.month)}],b:[/^(Jan|Feb|Mar|Apr|May|Jun(e?)|Jul(y?)|Aug|Sep(t?)|Oct|Nov|Dec)/gi,function(a){i.month=date._getMonthIndex(a),h.setMonth(i.month)}],y:[/^[0-9]{2}/g,function(a){a=Math.round(a)+1900,1950>a&&(a+=100),h.setFullYear(a)}],Y:[/^[0-9]{4}/g,function(a){i.year=Math.round(a),h.setFullYear(i.year)}]};for(j.l=j.I,j.e=j.d,j.P=j.p,j.h=j.b,e=0;e<b.length;e++)if("%"===b.charAt(e)){f=null," "===a.charAt(0)&&"%"===b.charAt(e)&&(a=a.substring(1));for(g in j)if(j.hasOwnProperty(g)&&b.substring(e+1,e+1+g.length)===g){f=j[g],a=a.replace(f[0],d),e+=f.length-1;break}}else a.charAt(0)===b.charAt(e)&&(a=a.substring(1));return(i.month||0===i.month)&&h.setMonth(i.month),(i.year||0===i.year)&&h.setFullYear(i.year),h},unformat:function(){return this.parse.apply(this,arguments)},format:function(a,b){if(b=b||"%d/%m/%Y",!a||a.constructor!==Date||!a.toDateString)return!1;var c=a.toDateString();if(!c||"invalid date"===c.toLowerCase())return!1;if("NaN"===c)return!1;var d=c.split(" "),e=a.getHours(),f=(e+11)%12+1,g=a.getMonth()+1,h={H:e,I:(10>f?"0":"")+f,l:f,p:e>11?"PM":"AM",P:e>11?"pm":"am",M:(a.getMinutes()<10?"0":"")+a.getMinutes(),S:(a.getSeconds()<10?"0":"")+a.getSeconds(),a:d[0],A:this.weekdays[a.getDay()],d:d[2],e:Math.round(d[2]),m:(10>g?"0":"")+g,B:this.months[Math.round(d[1])],b:d[1],h:d[1],y:d[3].substring(2),Y:d[3]};return b.replace(/%[HIlpPMSaAdemBbhyY]/gm,function(a){var b=h[a.charAt(1)+""];return b||0===b||b===!1?b:a})},_getMonthIndex:function(a){a=a.substring(0,3).toLowerCase();for(var b=0;b<this.months.length;b++)if(this.months[b].substring(0,3).toLowerCase()===a)return b;return-1},weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},puredom.FormHandler=function(a,b){var c=this;b=b||{},1===arguments.length&&"object"==typeof a&&a.constructor!==puredom.NodeSelection&&(b=a,a=b.form),puredom.EventEmitter.call(this),this._customTypes=[].concat(this._customTypes),a&&this.setForm(a),b.enhance===!0&&this.enhance(),b.data&&this.setData(b.data),b.onsubmit&&"function"==typeof b.onsubmit&&(this.on("submit",b.onsubmit),this._constructorSubmitHandler=b.onsubmit),b.oncancel&&"function"==typeof b.oncancel&&(this.on("cancel",b.oncancel),this._constructorCancelHandler=b.oncancel),b.submitButton&&"on"in b.submitButton&&(b.submitButton.on("click",this._defaultSubmitButtonHandler),this._constructorSubmitButton=b.submitButton),b.cancelButton&&b.cancelButton.on&&(b.cancelButton.on("click",function(a){return c.cancel(),puredom.cancelEvent(a)}),this._constructorCancelButton=b.cancelButton)},puredom.inherits(puredom.FormHandler,puredom.EventEmitter),puredom.extend(puredom.FormHandler.prototype,{errorMessageSelector:".errorMessage, .generalForm_errorMessage",setForm:function(a){var b=this;return this.form=puredom.el(a),this.action||(this.action=this.form.attr("action")),this.method||(this.method=this.form.attr("method")),puredom.el({type:"input",attributes:{type:"submit"},css:"position:absolute; left:0; top:-999em; width:1px; height:1px; font-size:1px; visibility:hidden;"},this.form),this.form.on("submit",function(a){return b.submit(),a.cancel()}),this._kill=function(){b=null},this},enhance:function(){var a=this,b=this._getFields();return b&&b.each(function(b){var c=a._getCustomType(b);c&&c.enhance&&c.enhance(b)}),a=b=null,this},disable:function(){return this.disabled=!0,this._getFields().disable(),this},enable:function(){return this.disabled=!1,this._getFields().enable(),this},destroy:function(){var a=this,b=this._getFields();return b&&b.each(function(b){var c=a._getCustomType(b);c&&c.destroy&&c.destroy(b)}),this._constructorSubmitHandler&&this.removeEventListener("submit",this._constructorSubmitHandler),this._constructorSubmitButton&&this._constructorSubmitButton.removeEvent("click",this._defaultSubmitButtonHandler),this._constructorCancelHandler&&this.removeEventListener("cancel",this._constructorCancelHandler),this._constructorCancelButton&&this._constructorCancelButton.removeEvent("click",this._constructorCancelHandler),a=b=null,this},clear:function(){return this.setData({},!0),this.clearErrors(),this},reset:function(){return this.clear.apply(this,arguments)},submit:function(){var a,b;return this.disabled===!0?(puredom.log("Notice: Not submitting disabled form."),this):(this.clearErrors(!1),a=this.getData(),this._hasErrors=!1,b=a?this._fireEvent("submit",[a]):this._fireEvent("submitfailed",[a]),this._hasErrors||b&&b.falsy===!0||this.clearErrors(),this)},cancel:function(){return this.disabled===!0?(puredom.log("Notice: Not cancelling on disabled form."),this):(this.clearErrors(),this._fireEvent("cancel"),this)},clearErrors:function(a){this._getFields().each(function(a){a.parent().declassify("error")}),a!==!1&&(this._hasErrors=!1,this.form.query(this.errorMessageSelector).first().css({height:0,opacity:0},{tween:"fast",callback:function(a){a.hide()}}))},showFieldErrors:function(a){var b=this;this._hasErrors=!0,puredom.forEach(a,function(a,c){var d;return a=(a||"Error")+"",a=a.replace(/\{fieldnames\.([^\}]+)\}/gim,function(a,c){var d=c&&b.form.query('[name="'+c+'"]').attr("id"),e=d&&b.form.query('label[for="'+d+'"]');return e&&e.exists()?(e._nodes[0].textContent||e._nodes[0].innerText||e._nodes[0].innerHTML||"").replace(/\:\s*?$/g,""):c}),b.form.query('[name="'+c+'"]').focus().parent().classify("error"),-1===a.indexOf(" ")&&(a=puredom.i18n(a.toUpperCase())),d=b.form.query(b.errorMessageSelector).first(),d.html('<div class="formHandlerErrorMessage">'+a+"</div>"),d.css({height:Math.round(d.prop("offsetHeight"))||0,opacity:0}).show().css({height:d.children().first().height()+"px",opacity:1},{tween:"medium"}),!1}),b=null},getData:function(){var a=null,b=this,c=this._getFields();return c&&(a={},c.each(function(c){var d=c.attr("name");d&&(a[d]=b._getInputValue(c))})),b=c=null,a},setData:function(a,b){var c=[],d=this,e=this._getFields();return a&&e&&e.each(function(e){var f=e.attr("name");a.hasOwnProperty(f)?(c.push(f),d._setInputValue(e,a[f])):b===!0&&d._setInputValue(e,null)}),d=e=null,this},addCustomType:function(a){var b=this,c=this._getFields();return this._customTypes.push(a),c&&a.enhance&&c.each(function(c){var d=b._getCustomType(c);d===a&&d.enhance(c)}),b=c=null,this},_getFields:function(){var a=null;return this.form&&(a=this.form.query("input,textarea,select")),a},_setInputValue:function(a,b){var c=this._getCustomType(a);return(void 0===b||null===b)&&(b=""),c&&c.setValue?c.setValue(a,b):a.value(b),this},_getInputValue:function(a){var b=this._getCustomType(a);return b&&b.getValue?b.getValue(a):a.value()},_getCustomType:function(a){var b,c,d,e;for(a.attr("customtype")?c=(a.attr("customtype")+"").toLowerCase():a.attr("type")&&(c=(a.attr("type")+"").toLowerCase()),d=(a.prop("nodeName")+"").toLowerCase(),b=0;b<this._customTypes.length;b++)if(e=this._customTypes[b],e.types&&this._arrayIndexNC(e.types,c)>-1||e.type&&(e.type+"").toLowerCase()===c||e.nodeNames&&this._arrayIndexNC(e.nodeNames,d)>-1||e.nodeName&&(e.nodeName+"").toLowerCase()===d)return e;return!1},_arrayIndexNC:function(a,b){b=(b+"").toLowerCase();for(var c=0;c<a.length;c++)if((a[c]+"").toLowerCase()===b)return c;return-1},_defaultSubmitButtonHandler:function(a){var b=puredom.el(this);do if("form"===b.nodeName()){b.submit();break}while((b=b.parent()).exists()&&"body"!==b.nodeName());return puredom.cancelEvent(a)},_customTypes:[]}),puredom.FormHandler.addCustomType=function(a){this.prototype._customTypes.push(a)},puredom.i18n=function(){var a,b={};return a=function(){return a.localize.apply(this,arguments)},a.getLang=function(a){a=a.toLowerCase().replace(/[^a-z0-9]/gim,"");for(var c in b)if(b.hasOwnProperty(c)&&(c+"").toLowerCase().replace(/[^a-z0-9]/gim,"")===a)return b[c];return!1},a.hasLang=function(b){return!!a.getLang(b)},a.setLang=function(b){return a.hasLang(b)&&(a.locale=a.lang=b),this},a.localizeDOM=function(b){b.query("[data-i18n-id]").each(function(b){var c,d,e=(b.attr("data-i18n-id")||"")+"",f=b.nodeName();if(e&&e.length>0&&(d=a.localize(e,null,""),d&&d!==e&&""!==d))switch(f){case"select":case"input":case"textarea":c=b.value(),c!==d&&b.value(d);break;default:c=b.html(),c!==d&&b.html(d)}})},a.localize=function(c,d,e,f){var g,h,i,j,k=puredom.typeOf(c),l=c;if(f=f||{},d=(d||a.lang||a.locale||"en").toUpperCase(),b.hasOwnProperty(d)?h=b[d]:d.indexOf("-")>-1&&(d=d.substring(0,d.indexOf("-")),b.hasOwnProperty(d)&&(h=b[d])),h&&null!==c&&void 0!==c)if("string"===k&&(c=c.replace(/\{([^{}]+)\}/gim,"$1")),h={labels:h.labels||{},formats:h.formats||{}},"string"!==k||c.match(/^(labels|formats)\./gim)||(c="labels."+c),"date"===k||c.constructor===Date)g=h.formats[f.datetype||"date"],i=g&&puredom.date.format(c,g)||c.toLocaleString();else if("number"===k){if(h.formats.thousands_separator)for(i="",j=c+"";j.length>0;)i=j.substring(Math.max(0,j.length-3))+i,j.length>3&&(i=h.formats.thousands_separator+i),j=j.substring(0,Math.max(0,j.length-3))}else i="boolean"===k?(c===!0?h.formats.booleanTrue:h.formats.booleanFalse)||c+"":puredom.delve(h,c+"");return i?i:null!==e&&void 0!==e?e:l},a.addLang=function(a,c){return a=(a+"").toUpperCase(),c.labels||(c={labels:c}),b[a]=c,this},puredom.addNodeSelectionPlugin("localize",function(){return a.localizeDOM(this),this}),a}(),puredom.NativeAPI=function(a){var b,c,d,e,f,g,h,i,j=(this instanceof puredom.NativeAPI?this:a)||{},k={},l={},m={},n={}.constructor,o=function(){};i=function(a){j.enableLogging!==!1&&window.console&&window.console.log&&window.console.log(a)},b=function(a){var b,c,e="";for(b in a)if(null===a[b]||void 0===a[b]||a[b].constructor===Function||a[b].constructor===n||"object"===puredom.typeOf(a[b])||d(a[b])){if(a[b]&&d(a[b]))for(c=0;c<a[b];c++)e+="&"+encodeURIComponent(b)+"[]="+encodeURIComponent(a[b])}else e+="&"+encodeURIComponent(b)+"="+encodeURIComponent(a[b]);return e},c=function(a){var b,c,d;for(b=1;b<arguments.length;b++){d=arguments[b];for(c in d)d.hasOwnProperty(c)&&(a[c]=d[c])}return a},d=function(a){return"[object Array]"===Object.prototype.toString.apply(a)},f=function(){},j.MessageStringWithData=g=function(a,b){this.message=b||"",c(this,a)},g.prototype.toString=g.prototype.toSource=function(){return this.message},h=function(a,b){function d(){}var e;return puredom.isArray(a.data)&&0===a.data.length&&(a.data={}),c(d.prototype,{getData:function(){return puredom.extend({},this)},getResponse:function(){return this.constructor.prototype._originalResponse},_originalResponse:b}),e=new d,c(e,a),function(){return a=e=b=null,arguments[0]}(e)},j.setGlobalParameter=function(a,b){void 0===b||arguments.length<2?delete l[a]:l[a]=b},j.setAuthParameter=function(a,b){void 0===b||arguments.length<2?delete m[a]:m[a]=b},k.cache={},k.getCacheKey=function(a,b){var c,d="",e=[],f=[];b=puredom.extend({},b||{}),delete b.callback,d=(a.type||"")+"||"+a.endpoint+"||";for(c in b)b.hasOwnProperty(c)&&"_cache"!==c&&"_nocache"!==c&&"_cache_deleteonly"!==c&&"callback"!==c&&f.push(c);for(f.sort(),c=0;c<f.length;c++)e.push(encodeURIComponent("o_"+f[c])+"="+encodeURIComponent(b[f[c]]+""));return d+=e.join("&")},k.getCached=function(a,b){var c=k.getCacheKey(a,b),d=k.cache.hasOwnProperty(c)?puredom.json.parse(k.cache[c]):null;return j.enableCacheLogging===!0&&console.log("CACHE: Getting ["+a.type+"] "+a.endpoint,b," --> ",d),d},k.uncache=function(a,b){var c=k.getCacheKey(a,b);j.enableCacheLogging===!0&&console.log("CACHE: Clearing ["+a.type+"] "+a.endpoint,b),delete k.cache[c]},k.cacheResponse=function(a,b,c){var d=k.getCacheKey(a,b);j.enableCacheLogging===!0&&console.log("CACHE: Storing ["+a.type+"] "+a.endpoint,b," --> ",c),k.cache[d]=puredom.json.stringify(c)},j.clearCache=function(){j.enableCacheLogging===!0&&console.log("CACHE: Purging all entries"),k.cache={}},k.validateParameters=function(a,b){var c,d,e,f,g,h,i={errors:[],message:""},j={nativeApiError:!0,clientSideError:!0};if(b.parameters){c={};for(d in b.parameters)b.parameters.hasOwnProperty(d)&&(e=b.parameters[d],f=puredom.typeOf(e),"function"===f&&e.name?(f="string",e=e.name.toLowerCase()):("regexp"===f||e.constructor===RegExp)&&(f="string",e="/"+e.source+"/"+(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")),"string"===f&&("/"===e.substring(0,1)?(e=/^\/(.*?)\/([gim]*?)$/gim.exec(e),c[d]={validate:"regex",against:new RegExp(e[1]||"",e[2]||"")}):c[d]={validate:"type",against:e.toLowerCase()}))}if(c)for(d in c)c.hasOwnProperty(d)&&(f=c[d].validate,e=c[d].against,g=a[d],h=null,"regex"===f&&(e.lastIndex=0),a.hasOwnProperty(d)&&null!==g&&void 0!==g&&""!==g?"regex"!==f||e.test(g+"")?"type"===f&&e!==puredom.typeOf(g)&&(h={field:d,type:"TypeError",message:"{fieldnames."+d+"} is invalid"}):h={field:d,type:"ValidationError",message:"{fieldnames."+d+"} is invalid"}:h={field:d,type:"RequiredError",message:"{fieldnames."+d+"} is required"},h&&(h.missingParameter=h.field,i.message+=(i.message.length>0?", ":"")+h.message+" ("+h.type+")",i.errors.push(puredom.extend(h,j))));return i.failed=i.errors.length>0,i},e=function(e,f,q){j[e][f]=function(r){var s,t,u,v,w,x,y,z,A,B=k.validateParameters(r=r||{},q),C=q.longPolling===!0||q.allowLongPolling===!0&&r.longPolling===!0,D=r.hasOwnProperty("longPolling"),E=r.longPolling;if(B.failed)return i("api."+e+"."+f+": Errors: "+B.message,9),r.callback(!1,B.errors[0],B.errors),!1;if(s=function(b,c){var i,l,m=b&&(b[a.statusProperty||"success"]===!0||1===b[a.statusProperty||"success"]),w=b.data||b||null,B=b.errorMessage||b.message||null,F=b[a.statusProperty||"success"];return c=c||{},c.apiMethod=q.endpoint,c.cached!==!0&&q.cache===!0&&j.enableCache===!0&&k.cacheResponse(q,r,b),q.verifyResult?m=q.verifyResult(b):(F!==!0&&F!==!1&&0!==F&&1!==F||b.constructor!==n&&!d(b))&&(m=b.constructor===n||d(b)?!0:!1,w=b,B=null),C&&m&&b.timedout===!0?(i=r,setTimeout(function(){j[e][f](i),s=i=m=b=w=B=F=null},1),!0):(w=h(w,b,c),l=new g(b,B),c.parseError===!0&&(m=!1,w=w.message||w,a.onParseError&&a.onParseError(b,c)),(q.onbeforecomplete||q.onBeforeComplete||q.precallback||o)(m,m===!0?w:l,b),m===!0?(r.onsuccess||q.onsuccess||o).call(a.endpoints[e][f],w,b):(r.onerror||q.onerror||o).call(a.endpoints[e][f],B,w,b),(r.oncomplete||r.callback||o).call(a.endpoints[e][f],m,m===!0?w:l,b),(q.oncomplete||q.onComplete||q.callback||o)(m,m===!0?w:l,b),a.onRequestCompleted&&a.onRequestCompleted(e+"."+f,w,m,z,r),s=t=u=v=x=y=z=C=D=E=A=l=null,r=p=null,void 0)},u=q.type&&q.type.toLowerCase()||"",v=q.endpoint,q.formatSuffix?v+=q.formatSuffix:a.formatSuffix&&(v+=a.formatSuffix),v.match(/^(http|https|ftp)\:/)||(v=a.root+v),A=r._cache===!1||r._nocache===!0,C){r.longPolling=null;try{delete r.longPolling}catch(F){}r.timeout=r.timeout||q.longPollingTimeout||j.longPollingTimeout||60}else if(q.cache===!0&&j.enableCache===!0)if(A){if(k.uncache(q,r),r._cache_deleteonly===!0)return}else if(w=k.getCached(q,r))return setTimeout(function(){s(w,{cached:!0,fresh:!1})},1),void 0;switch(r&&(v=v.replace(/\{([a-z0-9\-\._]+)\}/gim,function(a,b){if(r.hasOwnProperty(b)&&null!==r[b]&&void 0!==r[b]){try{delete r[b]}catch(c){r[b]=null}return r[b]}return a})),u){case"xdr":i("Cross-domain requests are not yet supported.",7);break;case"post":x={};for(var G in r)if(r.hasOwnProperty(G)&&"[object Function]"===Object.prototype.toString.apply(r[G])){x[G]=r[G],r[G]=null;try{delete r[G]}catch(H){}}z=y=c({},l,q.auth===!0?m:{},q.defaultParameters||{},r);for(G in x)x.hasOwnProperty(G)&&(r[G]=x[G]);x=null,puredom.net.request({url:v,type:"POST",post:y,callback:function(a,b){a&&b?s(b):this.jsonParseError===!0?s({status:!1,message:"Unable to parse server response",rawdata:this.responseText},{parseError:!0,clientsideErrorDetection:!0}):s({status:!1,message:"Connection error "+this.status},{clientsideErrorDetection:!0})},contentTypeOverride:"application/json"});break;case"jsonp":z=c({},l,q.auth===!0?m:{},q.defaultParameters||{},r),v+=b(z),(-1===v.indexOf("?")||v.indexOf("?")>v.indexOf("&"))&&(v=v.replace("&","?")),t=puredom.net.jsonp(v,s);break;default:z=c({},l,q.auth===!0?m:{},q.defaultParameters||{},r),v+=b(z),(-1===v.indexOf("?")||v.indexOf("?")>v.indexOf("&"))&&(v=v.replace("&","?")),puredom.net.request({url:v,type:"GET",callback:function(a,b){a&&b?s(b):this.jsonParseError===!0?s({status:!1,message:"Unable to parse server response",rawdata:this.responseText},{parseError:!0,clientsideErrorDetection:!0}):s({status:!1,message:"Connection error "+this.status},{clientsideErrorDetection:!0})},contentTypeOverride:"application/json"})}return D&&(r.longPolling=E),t}},j.constructor==={}.constructor&&(j=function(a){function b(){}for(var c in a)a.hasOwnProperty(c)&&(b.prototype[c]=a[c]);return new b}(j));var q,r;for(q in a.endpoints)if(a.endpoints.hasOwnProperty(q)){j[q]=new f;for(r in a.endpoints[q])a.endpoints[q].hasOwnProperty(r)&&e(q,r,a.endpoints[q][r])}if(j.globalParameters)for(var s in j.globalParameters)j.globalParameters.hasOwnProperty(s)&&j.setGlobalParameter(s,j.globalParameters[s]);return this.constructor!==arguments.callee?j:void 0},puredom.net={HttpRequest:function(a){puredom.extend(this,a)},get:function(a,b,c){return this.request(puredom.extend({url:a,type:"GET",callback:b},c||{}))},post:function(a,b,c,d){return this.request(puredom.extend({url:a,type:"POST",post:b,callback:c},d||{}))},multiLoad:function(a,b){if(!a)return!1;var c,d,e=-1,f=a.length,g=[],h=0,i=0;return c=function(f,j){if(f&&j){var k=a[e],l=j;k.process&&k.process.call&&(l=k.process(l),void 0===l&&(l=j)),g.push(l),b&&b(h>0,g,h,i),c=d=a=g=b=null}else d()},d=function(){e+=1;var g=a[e],h="string"==typeof g?{url:g}:g;h?http.request(h,c):f>e?d():b(!1,null,null,"No resources were available.")},d(),!0},request:function(a){var b,c;return a.url?(c=this,a=a||{},b=new puredom.net.HttpRequest({url:a.url,type:a.type||(a.post?"POST":"GET"),callback:a.callback||arguments[1]||function(){},post:a.post,headers:a.headers}),a.contentTypeOverride&&(b.contentTypeOverride=a.contentTypeOverride,delete a.contentTypeOverride),this.createXHR(b.url,function(a){if(b.request=a.xhr,b._xdrFrame=a.frame,a=null,b.post&&"object"===puredom.typeOf(b.post)&&(b.post=puredom.parameterize(b.post),"?"===b.post.substring(0,1)&&(b.post=b.post.substring(1))),b.request.onreadystatechange=function(){var a,d;if(b.request._orig&&(b.request.readyState=b.request._orig.readyState,b.request.status=b.request._orig.status,b.request.responseText=b.request._orig.responseText,b.request.responseXML=b.request._orig.responseXML),4===b.request.readyState){if(b._xdrFrame&&setTimeout(function(){c._freeIframes.push(b._xdrFrame),c=null},100),b.status=b.request.status,b.contentTypeOverride)a=b.contentTypeOverride.toLowerCase();else{try{a=b.request.getResponseHeader("Content-Type").toLowerCase()}catch(e){}a=a||""}if(b.responseText=b.request.responseText,a.match(/\/(json|javascript)$/gm)||"json"===a){b.responseType="json",d=b.responseJSON=null;try{d=b.responseJSON=JSON.parse(b.request.responseText.replace(/^[^\[\{]*(.*)[^\[\{]*$/g,"$1"))}catch(f){b.jsonParseError=!0}}else"application/xml"===a||"xml"===a?(b.responseType="xml",d=b.responseXML=b.request.responseXML):(b.responseType="text",d=b.responseText);b.callback&&b.callback(b.request.status<400,d)}},b.request.open(b.type,b.url,b.async!==!1),b.request.setRequestHeader("content-type","application/x-www-form-urlencoded"),b.request.setRequestHeader("x-requested-with","XMLHttpRequest"),b.headers)for(var d in b.headers)if(b.headers.hasOwnProperty(d))try{b.request.setRequestHeader(d,b.headers[d])}catch(e){}b.request.send(b.post||null)}),b):!1},jsonp:function(){var a=function(){return a.get.apply(a,arguments)},b=0;return a.get=function(a,c,d){var e,f,g,h;return"function"===puredom.typeOf(c)&&(d&&"object"===puredom.typeOf(d)&&(h=d),d=c,h&&(c=h)),c=c||{},c.callback&&!d&&(d=c.callback),c.timeout||(c.timeout=10),(a=a||c.url)?(c.params&&puredom.parameterize&&(a+=(a.indexOf("?")>-1?"&":"?")+puredom.querystring.stringify(c.params)),b+=1,c.callback=g="puredom_net_jsonp_"+b,function(){window[c.callback]=function(a){var b;if(d){try{d(a)}catch(c){b=c}d=null}if(f&&(f.stop(),f=null),b)throw b}}(),a.indexOf("{!callback}")>-1?a=a.replace("{!callback}",g):a+=(a.indexOf("?")<0?"?":"&")+encodeURIComponent(c.callbackParam||"callback")+"="+encodeURIComponent(g),this._head||(h=document.getElementsByTagName("head"),this._head=h&&h[0]),e=puredom.el({type:"script",attributes:{src:a,async:"async",type:"text/javascript"},parent:this._head||document.body}),f={id:g,stop:function(){f._timer&&clearTimeout(f._timer),window[g]=null;try{delete window[g]}catch(a){}d=null,e.attr("src","about:blank").remove(),g=f=e=null}},c.timeout&&c.timeout>0&&(f._timer=setTimeout(function(){d&&d({_requestTimedOut:!0,_jsonpTimedout:!0,success:!1,result:!1}),f&&f.stop()},Math.round(1e3*c.timeout))),a=c=h=null,f):!1},a}(),_freeIframes:[],_xhrIndex:0,createXHR:function(a,b){var c,d,e,f,g,h,i=!1,j=this;if(this._xhrIndex+=1,a&&(c=/^[a-z]{3,9}\:\/\/([^\/\?#]+)/gim.exec(a),c=c&&c[1],c&&c!==location.hostname)){for(i=!0,document.domain=location.hostname.match(/[^.]+\.[^.]+$/gim)[0],h=0;h<this._freeIframes.length;h++)if(this._freeIframes[h].getAttribute("data-xhr-domain")===c){d=this._freeIframes.splice(h,1)[0];
break}d?b(j._createXHRObj(d.contentWindow,d)):(d=document.createElement("iframe"),d.style.cssText="position:absolute; left:0; top:-1000px; width:1px; height:1px; border:none; overflow:hidden;",f=function(){var a,h;try{a=d.contentWindow,h=a&&a.document&&a.document.domain===document.domain&&a.document.body}catch(i){h=null}h&&h.innerHTML&&(clearInterval(g),d.onload=d.onerror=null,b(j._createXHRObj(a,d)),j=b=e=d=c=f=g=null)},d.onload=d.onerror=f,d.setAttribute("src",location.protocol+"//"+c+"/xd_receiver.html"),d.setAttribute("role","presentation"),d.setAttribute("tabindex","-1"),d.setAttribute("data-xhr-domain",c),document.body.appendChild(d),g=setInterval(f,50))}return i?void 0:(e=this._createXHRObj(),b(e),e)},_createXHRObj:function(a,b){var c;a=a||window;try{c=new a.XMLHttpRequest}catch(d){try{c=new a.ActiveXObject("Msxml2.XMLHTTP")}catch(e){c=new a.ActiveXObject("Microsoft.XMLHTTP")}}return{xhr:c,frame:b}}},puredom.Notifier=function(a){var b=this;puredom.EventEmitter.call(this),this._data={counter:0,list:{}},this._notificationClickHandler=function(a){return b._performAction(puredom.el(this).attr("data-notification-id"),"notificationclick",a),puredom.cancelEvent(a)},a=a||{},a.parent&&this._createBase(a.parent)},puredom.inherits(puredom.Notifier,puredom.EventEmitter),puredom.extend(puredom.Notifier.prototype,{show:function(a){var b;return a?(this._data.counter+=1,b={id:this._data.counter+"",timeout:a.timeout||this.timeout},this._data.list[b.id]=b,b.base=this._build(b.id,a),this._show(b.id),b.timeout&&this._resetTimeout(b.id),b):!1},_createBase:function(a){this.notifications_base?(this.notifications_base.remove(),this.notifications_base.appendTo(a)):this.notifications_base=puredom.el({className:"notifications_base"},a)},_build:function(a,b){var c,d;return c=puredom.el({className:"notification",css:"height:0; opacity:0;",attributes:{"data-notification-id":a},children:[{className:"notification_top"},{className:"notification_inner",children:[{className:"notification_inner_top"},{className:"notification_closeButton",children:[{className:"label",innerHTML:this.closeButtonLabel||"&times;"}]},{className:"notification_message",children:[{className:"label",innerHTML:b.message||b.text}]},{className:"notification_inner_bottom"}]},{className:"notification_bottom"}],onclick:this._notificationClickHandler},this.notifications_base),d=b.icon||b.image,d!==!1&&this.defaultIcon&&(d=this.defaultIcon),d&&puredom.el({type:"img",className:"notification_message",attributes:{src:b.icon||b.image||this.defaultIcon}},c.query(".notification_inner")),b.userDismiss===!1&&c.query(".notification_closeButton").hide(!0),c},_show:function(a){var b=this.get(a);b&&b.base.css({opacity:0}).css({opacity:1,height:b.base.children().height()},{tween:this.showTween||"medium"})},_hide:function(a){var b=this.get(a);b&&b.base.css({opacity:0,height:0},{tween:this.hideTween||"medium",callback:function(){b.base.remove(),b=null}})},_resetTimeout:function(a){var b=this.get(a),c=this;b&&(b._hideTimer&&clearTimeout(b._hideTimer),b.timeout&&(b._hideTimer=setTimeout(function(){c._hide(a),c=a=null},1e3*b.timeout)),b=null)},get:function(a){return a&&this._data.list.hasOwnProperty(a+"")&&this._data.list[a+""]||!1},_performAction:function(a,b,c){var d,e=this.get(a);if(puredom.isArray(c)||(c=[c]),b&&e&&(c=[a].concat(c),d=this._fireEvent(b,c),d!==!1))switch(b.toLowerCase()){case"notificationclick":case"notificationclicked":this._hide(a)}},timeout:15,_data:{counter:0,list:{}}}),puredom.RouteManager=function(a){var b=this;a=a||{},puredom.ControllerManager.call(this),this.allowTemplateFallback=a.allowTemplateFallback===!0||a.useBest===!0,this.allowPartialUrlFallback=a.allowPartialUrlFallback===!0,this._controllerUpdateState=function(a){b.doStateUpdate(b._routerState,a)}},puredom.inherits(puredom.RouteManager,puredom.ControllerManager),puredom.extend(puredom.RouteManager.prototype,{singular:!0,rewrites:[],restoreState:function(a){this.initialized!==!0?this._initState=a:a&&a.current_url?this.route(a.current_url):this.routeDefault()},doStateUpdate:function(a,b){var c,d;this._routerState=a&&puredom.extend({},a),a&&a.current&&(c=this.get(a.current),delete a.current,d=this._templateUrl(c.customUrl||c.urlTemplate||c.name,c),"/"!==d.substring(0,1)&&(d="/"+d),a.current_url=d),this.updateState(a,b)},register:function(a,b){return b.updateState=b.updateRouterState=this._controllerUpdateState,puredom.ControllerManager.prototype.register.call(this,a,b)},route:function(a){var b,c,d,e,f,g,h,i=this._controllers,j=a.replace(/^[#!\/]+/gm,"").replace(/#.+$/gm,"");for(c=0;c<i.length;c++){if(b=i[c],e=b.customUrl||b.urlTemplate||b.name,f={},this._checkUrlMatch(e,a,f)===!0){g={};for(d in f)"params."===(d+"").substring(0,7)&&(g[d.substring(7)]=f[d]);return this.load(b.name,{params:g})}this.allowPartialUrlFallback===!0&&this._checkUrlMatch(e,a,f,{partial:!0})===!0&&(h=b.name)}return h?this.load(h,{params:{}}):this.allowTemplateFallback!==!1&&this.get(j)?this.load(j,{params:{}}):(this._fireEvent("routingError",[{attemptedFallback:this.allowTemplateFallback!==!1,url:a,type:"RoutingError"}]),!1)},routeDefault:function(){return this.loadDefault()},_templateUrl:function(a,b){return b=b||this.current(),puredom.template(a,b,!1)},_checkUrlMatch:function(a,b,c,d){var e,f=this._getUrlSegments(a),g=this._getUrlSegments(b),h=/^\{([^{}]+)\}$/gim,i=!0;if(d=d||{},c=c||{},d.partial===!0)for(e=f.length;e--;)f[e].match(h)&&f.splice(e,1);if(g.length===f.length)for(e=0;e<g.length;e++){if(g[e]!==f[e]&&!f[e].match(h)){i=!1;break}c[f[e].replace(h,"$1")]=g[e]}else i=!1;return i},_getUrlSegments:function(a){var b,c=(a+"").split("/");for(b=c.length;b--;)0===c[b].replace(/(\s|\/)/gm,"").length&&c.splice(b,1);return c}}),puredom.StateManager=function(a,b){var c;if(b||"object"!==puredom.typeOf(a)||(b=a,a=b.adapter||b.adaptor),b=b||{},b.adaptor&&(b.adapter=b.adaptor,b.adapter=null),a=a||b.adapter,this.initialized=!1,this.objects={},this.states={},a&&this.adapters[a]||(a=this.defaultAdapter),this.adapter=puredom.extend({},this.adapters.none,this.adapters[a],{stateManager:this}),this.adapter.init&&this.adapter.init(puredom.extend({},b.adapterOptions||b.adaptorOptions||{},{adapter:a}),this),b.state&&(this.adapter.setState(b.state),this.restoreFromState(b.state)),b.objects)for(c in b.objects)this.addObject(c,b.objects[c])},puredom.extend(puredom.StateManager.prototype,{saveQueueDelay:50,replaceTimeout:0,adapters:{session:{getState:function(a){a(this.state)},setState:function(a,b){this.state=a,b(!0)},state:{}},base:{getState:function(a){setTimeout(function(){throw new Error("StateManager:: getState method not defined for the specified adapter.")},1),a({})},setState:function(a,b){setTimeout(function(){throw new Error("StateManager:: setState method not defined for the specified adapter.")},1),b(!0)}}},objects:{},states:{},initialized:!1,init:function(a){if(this.initialized===!0)return this;if(a=a||{},a.state&&(this.adapter.setState(a.state),this.restoreFromState(a.state)),a.objects)for(var b in a.objects)this.addObject(b,a.objects[b]);return this.initialized=!0,a.restore!==!1&&this.restore(),this.startPolling(),this},destroy:function(){this.stopPolling(),this.adapter.stateManager=null,this.adapter=this.states=this.objects=null,this.initialized=!1},startPolling:function(){this.adapter&&this.adapter.startPolling&&this.adapter.startPolling()},stopPolling:function(){this.adapter&&this.adapter.stopPolling&&this.adapter.stopPolling()},addObject:function(a,b,c){var d;return this.objects.hasOwnProperty(a)?(setTimeout(function(){throw new Error("Cannot add duplicate object ID '"+a+"' to state list.")},1),c&&c(!1)):(d=this,this.objects[a]=b,this.states[a]={},b.updateState=function(b,c,e){d.setObjState(a,puredom.extend({},d.getObjState(a),b),c||d.emptyFunc,e)},b.setState=function(b,c,e){d.setObjState(a,b,c||d.emptyFunc,e)},b.getState=function(){return d.getObjState(a)},b.destroyStateManagerConnections=function(){this.updateState=this.setState=this.getState=this.destroyStateManagerConnections=d.emptyFunc,d=null},b=null,this.initialized===!0&&this.restoreOne(a,function(){})),this},addObj:function(){return this.addObject.apply(this,arguments)},removeObject:function(a,b){if(this.objects.hasOwnProperty(a)){this.objects[a].destroyStateManagerConnections&&this.objects[a].destroyStateManagerConnections(),this.objects[a]=null,this.states[a]=null;try{delete this.objects[a],delete this.states[a]}catch(c){}this.save(b)}return this},removeObj:function(){return this.removeObject.apply(this,arguments)},restoreFromState:function(a,b,c){var d,e,f=this,g=0,h=0;d=b?function(){h+=1,h>=g&&(c!==!1?f.save(function(){b&&b(!0),f=b=null}):(b&&b(!0),f=b=null))}:function(){},"string"===puredom.typeOf(a)&&(a=puredom.json(a));for(e in this.objects)this.objects[e].restoreState&&(g+=1,this.objects[e].restoreState(a[e]),d());return 0===g&&(b&&b(!1),f=b=null),this},disableSave:function(){this._saveDisabled=!0},enableSave:function(){this._saveDisabled=!1},restoreOne:function(a,b){var c=this;this.adapter.getState(function(d){c.objects[a]&&c.objects[a].restoreState&&c.objects[a].restoreState(d[a]),c=null,b&&b()})},restore:function(a){var b=this;return this._restoring=!0,this.adapter.getState(function(c){var d=c&&puredom.json(c);b._lastSaveTime=(new Date).getTime(),d&&d!==b.currentState?(b.currentState=d,b.restoreFromState(c,function(){b._restoring=!1,a&&a(),b=null},!1)):b.save(function(){b._restoring=!1,b=null,a&&a(!1),a=null})}),this},save:function(a,b,c){var d=this;return c=c||{},this.initialized!==!0||this._saveDisabled||(b===!0?(this.currentSaveTimer&&(clearTimeout(this.currentSaveTimer),delete this.currentSaveTimer),this.getStateObj(function(b){var e=puredom.json(b),f=(new Date).getTime(),g=f-(d._lastSaveTime||f);d._lastSaveTime=f,e!==d.currentState?(d.currentState=e,d.adapter.setState(b,function(b){a&&"function"===puredom.typeOf(a)&&a(!!b),d=a=c=null},{replace:c.replace===!0||d.replaceTimeout&&0!==g&&g<d.replaceTimeout})):a&&"function"===puredom.typeOf(a)&&(a(),d=a=c=null)})):this.currentSaveTimer||(this.currentSaveTimer=setTimeout(function(){d.save(a,!0,c),delete d.currentSaveTimer,d=a=c=null},this.saveQueueDelay))),this},setObjState:function(a,b,c){var d;c&&"object"==typeof c&&(d=c),this.states[a]=b,this.save(c,d&&d.now===!0||c===!0,d)},getObjState:function(a,b){this.states[a]=b},getStateObj:function(a){return a&&a(this.states),this},emptyFunc:function(){}}),puredom.StateManager.prototype.adapters.url={init:function(a){var b=this,c=this._doPoll,d=this._doPollTimed;this._doPoll=function(){return c.apply(b,arguments)},this._doPollTimed=function(){return d.apply(b,arguments)},this.usePreceedingSlash=a.usePreceedingSlash!==!1,this.urlMapping=a.urlMapping,this.urlHistory=[],a.html5UrlPrefix&&(this.html5UrlPrefix=a.html5UrlPrefix),a.beforeParse&&(this.beforeParse=a.beforeParse),a.beforeCommit&&(this.beforeCommit=a.beforeCommit)},getPrefix:function(){return this.html5UrlPrefix?"function"==typeof this.html5UrlPrefix?this.html5UrlPrefix():this.html5UrlPrefix:""},usePreceedingSlash:!0,pollInterval:30,urlHistory:[],startPolling:function(){this.polling||(this.polling=!0,this.getCurrentUrl(!0),this.pollingTimer=setTimeout(this._doPollTimed,this.getPollInterval()),puredom.addEvent(window,"hashchange,pushstate,popstate",this._doPoll))},stopPolling:function(){clearTimeout(this.pollingTimer),puredom.removeEvent(window,"hashchange,pushstate,popstate",this._doPoll),this.polling=!1},getPollInterval:function(){return this.stateManager&&(this.stateManager.pollInterval||this.stateManager.adapterPollInterval)||this.pollInterval},_doPoll:function(){var a=this,b=a.currentUrl||null,c=a.getCurrentUrl(!0)||null;c!==b&&((new Date).getTime(),a.stateManager.disableSave(),a.stateManager.restore(function(){a.stateManager.enableSave(),a=b=c=null}))},_doPollTimed:function(){this._doPoll.apply(this,arguments),this.pollingTimer&&clearTimeout(this.pollingTimer),this.polling&&(this.pollingTimer=setTimeout(this._doPollTimed,this.getPollInterval()))},normalizeUrl:function(a){return(this.usePreceedingSlash?"/":"")+a.replace(/^[#!\/]+/gm,"").replace(/#.+$/gm,"")},getCurrentUrl:function(a){var b=location.href+"",c=b.indexOf("#!"),d=b.indexOf(location.host);return c>-1?(b=b.substring(c+2),window.history.replaceState&&window.history.replaceState(null,null,b)):b=d>-1?b.substring(d+location.host.length):null,(b||""===b)&&(b=this.normalizeUrl(b)),a===!0&&(b!==this.currentUrl&&this.urlHistory[this.urlHistory.length-1]!==b&&this.urlHistory.push(b),this.currentUrl=b),b||!1},setCurrentUrl:function(a,b){var c,d,e,f=this.getCurrentUrl(!1);a=this.normalizeUrl(a),c="#!"+a,e=this.urlHistory.length>0&&this.urlHistory[this.urlHistory.length-1]===a,a===f||e||(window.history.pushState?("/"!==a.substring(0,1)&&(a="/"+a),d=this.getPrefix().replace(/\/$/,""),a=d+a,this.beforeCommit&&(a=this.beforeCommit(a)||a),b===!0&&window.history.replaceState?window.history.replaceState(null,null,a):window.history.pushState(null,null,a)):window.location.href!==c&&(b===!0&&window.location.replace?window.location.replace(c):window.location.href=c),this.getCurrentUrl(!0))},setState:function(a,b,c){var d,e=location.href+"";e.indexOf("#!"),this.getCurrentUrl(!1),c=c||{},d=this.stringify(a),this.setCurrentUrl(d,c.replace===!0),b(!0)},getState:function(a){var b,c=this.getCurrentUrl(!0);c?(b=this.parse(c),a(b)):a(!1)},parse:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q={};for(o=function(a){return!!a.match(/^\-?[0-9]+$/)},p=function(a){if("undefined"===a)a=void 0;else if("null"===a)a=null;else if(a.match(/^\-?[0-9]+$/))a=parseInt(a,10);else if(a.match(/^\-?[0-9\.]+$/))a=parseFloat(a);else if(a.match(/^(true|false)$/i))a="true"===a.toLowerCase();else if(a.match(/^\[[a-z0-9%_\-]+(,[a-z0-9%_\-]+)*\]$/)){a=a.substring(1,a.length-1).split(",");for(var b=0;b<a.length;b++)a[b]=p(a[b])}return a},this.beforeParse&&(b=this.beforeParse(a),(b||""===b)&&(a=b)),c=this.getPrefix(),c&&a.substring(0,c.length)===c&&(a=a.substring(c.length)),this.usePreceedingSlash!==!1&&"/"===a.charAt(0)&&(a=a.substring(1)),n=a.indexOf("?"),-1===n&&-1===a.indexOf("=")&&(n=a.length),this.urlMapping&&n>0&&(m=a.substring(0,n),a=encodeURIComponent(this.urlMapping)+"="+encodeURIComponent(m)+"&"+a.substring(n+1)),"?"===a.substring(0,1)&&(a=a.substring(1)),d=a.split("&"),e=0;e<d.length;e++){if(g=d[e].indexOf("="),h=decodeURIComponent(d[e].substring(0,g)),j=decodeURIComponent(d[e].substring(g+1)),i=decodeURIComponent(j),h.match(/\[\]$/g))for(h=h.substring(0,h.length-2),i=i.split(","),f=0;f<i.length;f++)i[f]=decodeURIComponent(i[f]);else i=p(i);for(h=h.split("."),l=q,f=0;f<h.length;f++)k=h[f],o(k)&&(k=parseInt(k.replace(/[^0-9]/,""),10)),f<h.length-1?(l[k]||(l[k]=o(h[f+1])?[]:{}),l=l[k]):l[k]=i}return q},stringify:function(a){var b,c="",d="",e=this.urlMapping;return b=function(a,f){var g,h;switch(puredom.typeOf(a)){case"object":for(g in a)a.hasOwnProperty(g)&&b(a[g],(f?f+".":"")+g);break;case"array":for(h=!0,g=0;g<a.length;g++)t=puredom.typeOf(a[g]),"string"!==t&&"number"!==t&&"boolean"!==t&&(h=!1);if(h)for(c+="&"+encodeURIComponent(f)+"[]=",g=0;g<a.length;g++)c+=(g>0?",":"")+encodeURIComponent(a[g]);else for(g=0;g<a.length;g++)b(a[g],(f?f+".":"")+g);break;case"null":case"undefined":case"function":break;default:e&&f===e?d=a:c+="&"+encodeURIComponent(f)+"="+encodeURIComponent(a)}},b(a),b=a=null,"&"===c.substring(0,1)&&(c="?"+c.substring(1)),this.usePreceedingSlash!==!1&&"/"!==d.charAt(0)&&(d="/"+d),d+c}},puredom.StateManager.prototype.adapters.urlbasic={setState:function(a,b,c){var d=location.href+"",e=d.indexOf("#!");e>-1&&(d=d.substring(0,e)),d+="#!"+this.serializeState(a),c&&c.replace===!0&&"function"==typeof location.replace?location.replace(d):location.href=d,b(!0)},getState:function(a){var b,c=location.href+"",d=c.indexOf("#!");d>-1?(c=c.substring(d+2),b=puredom.json.parse(c),a(b)):a(!1)},serializeState:function(a){return puredom.json.stringify(a)}},puredom.StateManager.prototype.adapters.cookies={init:function(a){a=a||{},this.dbName=a.dbName||"state"},setState:function(a,b){puredom.cookies.set(this.dbName,puredom.json.stringify(a)),b(!0)},getState:function(a){var b=puredom.cookies.get(this.dbName);b=puredom.json.parse(b),a(b)},serializeState:function(a){return puredom.json.stringify(a)}},puredom.TestSuite=function(){puredom.EventEmitter.call(this),this.list={}},puredom.inherits(puredom.TestSuite,puredom.EventEmitter),puredom.extend(puredom.TestSuite.prototype,{add:function(a,b){var c=this._getIdFromName(a);this.list[c]={name:a,test:b,results:[]}},run:function(a,b,c){var d,e,f,g,h,i=this,j=this.get(a),k=j&&j.test,l=null;k&&k.run&&(e=function(b,d){if("status"===b&&(h=d),"result"===b)l=d===!0;else if(c)return i.fireEvent(b,a,d),c(b,d),!1},d=function(m){k.cleanup&&k.cleanup(g),m?h=m:g.results&&(h=g.results),m&&j.results.push({time:(new Date).getTime(),results:m}),i.fireEvent("finish",a,h,l),b&&b(h,l),f.destroy(),i=d=e=h=j=k=f=g=b=c=null},f=this._createSandboxController(j),f.messageHandler=e,f.onfinish=d,g=f.getSandbox(),k.prepare&&k.prepare(g),results=k.run(g))},get:function(a){var b=this._getIdFromName(a);return this.list.hasOwnProperty(b)&&this.list[b]||!1},getList:function(){var a,b=[];for(a in this.list)this.list.hasOwnProperty(a)&&this.list[a].name&&b.push(this.list[a].name);return b},_getIdFromName:function(a){return(a+"").toLowerCase().replace(/[^a-z0-9_]+/gm,"")},_createSandboxController:function(a){var b=this,c={},d={};return c.getSandbox=function(){return d},c.destroy=function(){d=c=b=a=null},d.status=d.setStatus=function(d){var e;c.messageHandler&&(e=c.messageHandler.call(b,"status",d)),e!==!1&&puredom.log('tests["'+a.name+'"] >> '+d)},d.log=d.postMessage=function(d){var e;c.messageHandler&&(e=c.messageHandler.call(b,"log",d)),e!==!1&&puredom.log('tests["'+a.name+'"] >> '+d)},d.done=d.finish=d.complete=function(a){c.onfinish&&setTimeout(function(){c.messageHandler&&c.messageHandler.call(b,"status",a),c.onfinish&&c.onfinish.call(b,a),a=null},1)},d.pass=function(a){c.messageHandler&&c.messageHandler.call(b,"result",!0),c.onpass&&c.onpass.call(b,!0),d.done(a)},d.fail=function(a){c.messageHandler&&c.messageHandler.call(b,"result",!1),c.onfail&&c.onfail.call(b,fail),d.done(a)},c},list:{}}),puredom.ViewManager=function(a){puredom.EventEmitter.call(this),this._htmlViews={},this._postProcessors=[],a&&a.init===!0&&this.init(a)},puredom.inherits(puredom.ViewManager,puredom.EventEmitter),puredom.extend(puredom.ViewManager.prototype,{viewDomPrefix:"views_",_regs:{node:/<(\/?)([a-z][a-z0-9]*)(\s+[a-z0-9._-]+=(['"]).*?\4)*\s*\/?>/gim},init:function(a){a=a||{},this.initialized!==!0&&(this.initialized=!0,a.viewDomPrefix&&(this.viewDomPrefix=a.viewDomPrefix),this.cacheBase=puredom.el({className:"views_cacheBase",css:"display: none;"},a.cacheBase||document.body))},destroy:function(){if(this.initialized===!0){this.initialized=!1;try{this.cacheBase.remove()}catch(a){}}},log:function(a,b){this.logging===!0&&puredom.log("ViewManager :: "+a,b)},addView:function(a,b){"string"===puredom.typeOf(b)?this._htmlViews[(a+"").toLowerCase()]=b:this.load(a,!1)},exists:function(a){return this._htmlViews.hasOwnProperty((a+"").toLowerCase())},template:function(a,b,c,d){var e,f;return a=(a+"").toLowerCase(),b=b||{},this._htmlViews.hasOwnProperty(a)&&(f=this._htmlViews[a],e=this.load(puredom.template(f,b),c,d,null,!1)),e||!1},load:function(a,b,c,d,e){var f,g,h;return a&&(h=e!==!1&&this.getCachedView(a),h?(this.log('Using cached view for "'+a+'".'),f=this.buildCachedView(h)):"string"===puredom.typeOf(a)&&(this._regs.node.lastIndex=0,this._regs.node.test(a)?(this.log('Parsing HTML view for "'+a+'".'),f=this.buildViewFromHTML(a),a=null):this._htmlViews.hasOwnProperty((a+"").toLowerCase())?(this.log('Loading stored HTML view for "'+a+'".'),f=this.buildViewFromHTML(this._htmlViews[(a+"").toLowerCase()])):(this.log('Looking up in-DOM view for "'+a+'"...'),g=this.getViewFromDOM(a),g&&g.exists()?(this.log("Lookup succeeded, view found."),f=this.buildViewFromDOM(g,d!==!1)):this.log("Lookup failed, no matching view found.")))),f&&f.exists()?(a&&(this.log('View "'+a+'" loaded.'),e!==!1&&this.cacheView(a,f,d!==!1),f.classify("views_"+a)),f.parent().exists()||(c&&c.parent().insertBefore(f,c),!c&&b&&f.insertInto(b)),this.postProcessView(f),f):(puredom.log('ViewManager :: Unable to find view "'+a+'".'),!1)},unload:function(a){a&&a.destroy&&a.destroy()},_postProcessors:[],addViewPostProcessor:function(a){var b,c=!1;for(b=this._postProcessors.length;b--;)if(this._postProcessors[b]===a){c=!0;break}c||this._postProcessors.push(a)},postProcessView:function(a){for(var b=0;b<this._postProcessors.length;b++)this._postProcessors[b](a)},getViewFromDOM:function(a,b){var c;return b=b||this.viewDomPrefix,b.match(/[a-z0-9_-]/i)&&(b="#"+b),a=a.replace(/[\s.\/\\]/gim,""),this.log('Lookup: prefix="'+b+'", def="'+a+'"'),b&&(c=puredom.el(b+a),c&&c.exists())?c:!1},buildViewFromHTML:function(a){var b=puredom.el({innerHTML:a});return b=b.children(),b.remove(),b.exists()&&b||!1},buildViewFromObj:function(a){var b;return puredom.isArray(a)?(b=tinyom.el({children:a}),b=b.children()):(a=puredom.extend({},a,{parent:null,insertBefore:null}),b=puredom.el(a)),b.exists()&&b||!1},buildViewFromDOM:function(a,b){var c;return a=puredom.el(a),b===!1?a:(c=a.clone(!0),c.exists()&&c||!1)},_htmlViews:{},cacheBase:null,getCachedView:function(a){var b=this.cacheBase.query('[data-viewname="'+a+'"]').first();return b.exists()&&b||!1},buildCachedView:function(a){var b;return"string"===puredom.typeOf(a)&&(a=this.getCachedView(a)),b=a&&this.buildViewFromDOM(a),b&&b.attr("id",this.viewDomPrefix+b.attr("data-viewname")),b},cacheView:function(){return!1}});